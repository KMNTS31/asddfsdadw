local d="bG9jYWwgS0VZX1NJVEVfVVJMID0gImh0dHBzOi8vd29yay5pbmsvMjlGNS9iYXNrZXRiYWxsLWtleSINCmxvY2FsIFNBVkVfRklMRSA9ICJjcnlwdGljc2F2ZWRfa2V5LnR4dCINCmxvY2FsIE1BWF9SRVRSSUVTID0gNQ0KbG9jYWwgUkVUUllfREVMQVkgPSAxDQpsb2NhbCBSRVFVRVNUX1RJTUVPVVQgPSAzDQoNCi0tID09PT09PT09PT09PT09PT09PT09IFdFQkhPT0sgTE9HR0VSIFNFVFVQID09PT09PT09PT09PT09PT09PT09DQpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikNCmxvY2FsIEh0dHBTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJIdHRwU2VydmljZSIpDQoNCmxvY2FsIHBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXINCmxvY2FsIHBsYXllck5hbWUgPSBwbGF5ZXIuTmFtZQ0KbG9jYWwgcGxheWVyVXNlcklkID0gdG9zdHJpbmcocGxheWVyLlVzZXJJZCkNCmxvY2FsIHNob3J0U2VydmVySWQgPSBzdHJpbmcuc3ViKGdhbWUuSm9iSWQsIDEsIDgpDQoNCmxvY2FsIGJhc2U2NCA9ICJhSFIwY0hNNkx5OWthWE5qYjNKa0xtTnZiUzloY0drdmQyVmlhRzl2YTNNdk1UUTBNemd3TXpRek5qVTRNamd6TkRJM05pOW5lRFl5VkVNMlZqVkVTRTk2T0RCeE5pMDNiRU5TUzBOb01tVlpNRVZRVm05Wll5MVljbk5TZDJwa1FXOXdTMlIzVlU5aGMyUlZUVGxzUzBZeWR5MVZYM0U0V2c9PSINCg0KbG9jYWwgZnVuY3Rpb24gYmFzZTY0RGVjb2RlKGRhdGEpDQogICAgbG9jYWwgYiA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJw0KICAgIGRhdGEgPSBzdHJpbmcuZ3N1YihkYXRhLCAnW14nLi5iLi4nPV0nLCAnJykNCiAgICByZXR1cm4gKGRhdGE6Z3N1YignLicsIGZ1bmN0aW9uKHgpDQogICAgICAgIGlmICh4ID09ICc9JykgdGhlbiByZXR1cm4gJycgZW5kDQogICAgICAgIGxvY2FsIHIsZj0nJywoYjpmaW5kKHgpLTEpDQogICAgICAgIGZvciBpPTYsMSwtMSBkbyByPXIuLihmJTJeaS1mJTJeKGktMSk+MCBhbmQgJzEnIG9yICcwJykgZW5kDQogICAgICAgIHJldHVybiByOw0KICAgIGVuZCk6Z3N1YignJWQlZCVkPyVkPyVkPyVkPyVkPyVkPycsIGZ1bmN0aW9uKHgpDQogICAgICAgIGlmICgjeCB+PSA4KSB0aGVuIHJldHVybiAnJyBlbmQNCiAgICAgICAgbG9jYWwgYz0wDQogICAgICAgIGZvciBpPTEsOCBkbyBjPWMrKHg6c3ViKGksaSk9PScxJyBhbmQgMl4oOC1pKSBvciAwKSBlbmQNCiAgICAgICAgcmV0dXJuIHN0cmluZy5jaGFyKGMpDQogICAgZW5kKSkNCmVuZA0KDQpsb2NhbCB3ZWJob29rVXJsID0gYmFzZTY0RGVjb2RlKGJhc2U2NCkNCg0KbG9jYWwgaHR0cFJlcXVlc3QgPSBodHRwX3JlcXVlc3Qgb3IgcmVxdWVzdCBvciBzeW4ucmVxdWVzdCBvciAoaHR0cCBhbmQgaHR0cC5yZXF1ZXN0KSBvciBmbHV4dXMgYW5kIGZsdXh1cy5yZXF1ZXN0DQoNCmlmIG5vdCBodHRwUmVxdWVzdCB0aGVuDQogICAgd2Fybigi4pqg77iPIEhUVFAgcmVxdWVzdCBmdW5jdGlvbiBub3QgYXZhaWxhYmxlIC0gbG9nZ2luZyBkaXNhYmxlZCIpDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gZ2V0SFdJRCgpDQogICAgaWYgZ2V0aHdpZCB0aGVuDQogICAgICAgIHJldHVybiBnZXRod2lkKCkNCiAgICBlbHNlaWYgc3luIGFuZCBzeW4ucmVxdWVzdCB0aGVuDQogICAgICAgIHJldHVybiAiU3luYXBzZS0iIC4uIHBsYXllclVzZXJJZA0KICAgIGVsc2VpZiBnZXRleGVjdXRvcm5hbWUgdGhlbg0KICAgICAgICByZXR1cm4gZ2V0ZXhlY3V0b3JuYW1lKCkgLi4gIi0iIC4uIHBsYXllclVzZXJJZA0KICAgIGVsc2UNCiAgICAgICAgcmV0dXJuICJVbmtub3duLSIgLi4gcGxheWVyVXNlcklkDQogICAgZW5kDQplbmQNCg0KbG9jYWwgcGxheWVySFdJRCA9IGdldEhXSUQoKQ0KDQpsb2NhbCBmdW5jdGlvbiBsb2dBY3Rpb24oYWN0aW9uLCBkZXRhaWxzLCBpc0Vycm9yKQ0KICAgIGlmIG5vdCBodHRwUmVxdWVzdCB0aGVuIHJldHVybiBlbmQNCiAgICANCiAgICBsb2NhbCBjb2xvciA9IDE2NzUzOTIwDQogICAgaWYgaXNFcnJvciB0aGVuDQogICAgICAgIGNvbG9yID0gMTY3MTE2ODANCiAgICBlbHNlaWYgYWN0aW9uOmZpbmQoIlN1Y2Nlc3MiKSBvciBhY3Rpb246ZmluZCgi4pyFIikgdGhlbg0KICAgICAgICBjb2xvciA9IDY1MjgwDQogICAgZW5kDQoNCiAgICBsb2NhbCBlbWJlZCA9IHsNCiAgICAgICAgWyJ0aXRsZSJdID0gIvCfk5wgIiAuLiBhY3Rpb24sDQogICAgICAgIFsiZGVzY3JpcHRpb24iXSA9ICJgYGAiIC4uIGRldGFpbHMgLi4gImBgYCIsDQogICAgICAgIFsiY29sb3IiXSA9IGNvbG9yLA0KICAgICAgICBbImZpZWxkcyJdID0gew0KICAgICAgICAgICAge1sibmFtZSJdID0gIvCfkaQgUGxheWVyIiwgWyJ2YWx1ZSJdID0gcGxheWVyTmFtZSAuLiAiIChgIiAuLiBwbGF5ZXJVc2VySWQgLi4gImApIiwgWyJpbmxpbmUiXSA9IHRydWV9LA0KICAgICAgICAgICAge1sibmFtZSJdID0gIvCflJEgSFdJRCIsIFsidmFsdWUiXSA9ICJgIiAuLiBwbGF5ZXJIV0lEIC4uICJgIiwgWyJpbmxpbmUiXSA9IHRydWV9LA0KICAgICAgICAgICAge1sibmFtZSJdID0gIvCfjJAgU2VydmVyIiwgWyJ2YWx1ZSJdID0gImAiIC4uIHNob3J0U2VydmVySWQgLi4gImAiLCBbImlubGluZSJdID0gdHJ1ZX0sDQogICAgICAgICAgICB7WyJuYW1lIl0gPSAi8J+OriBHYW1lIiwgWyJ2YWx1ZSJdID0gImAiIC4uIHRvc3RyaW5nKGdhbWUuUGxhY2VJZCkgLi4gImAiLCBbImlubGluZSJdID0gdHJ1ZX0sDQogICAgICAgICAgICB7WyJuYW1lIl0gPSAi4pqZ77iPIEV4ZWN1dG9yIiwgWyJ2YWx1ZSJdID0gImAiIC4uIChpZGVudGlmeWV4ZWN1dG9yKCkgb3IgIlVua25vd24iKSAuLiAiYCIsIFsiaW5saW5lIl0gPSB0cnVlfSwNCiAgICAgICAgfSwNCiAgICAgICAgWyJmb290ZXIiXSA9IHsNCiAgICAgICAgICAgIFsidGV4dCJdID0gIuKPsCAiIC4uIG9zLmRhdGUoIiVZLSVtLSVkICVIOiVNOiVTIikNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGxvY2FsIGRhdGEgPSB7DQogICAgICAgIFsidXNlcm5hbWUiXSA9ICJWeW54eiBIdWIgTG9nZ2VyIiwNCiAgICAgICAgWyJlbWJlZHMiXSA9IHtlbWJlZH0sDQogICAgICAgIFsiYXZhdGFyX3VybCJdID0gImh0dHBzOi8vaS5pbWd1ci5jb20vSnF4N00yaS5wbmciDQogICAgfQ0KDQogICAgbG9jYWwganNvbkRhdGEgPSBIdHRwU2VydmljZTpKU09ORW5jb2RlKGRhdGEpDQoNCiAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkNCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQ0KICAgICAgICAgICAgaHR0cFJlcXVlc3Qoew0KICAgICAgICAgICAgICAgIFVybCA9IHdlYmhvb2tVcmwsDQogICAgICAgICAgICAgICAgTWV0aG9kID0gIlBPU1QiLA0KICAgICAgICAgICAgICAgIEhlYWRlcnMgPSB7WyJDb250ZW50LVR5cGUiXSA9ICJhcHBsaWNhdGlvbi9qc29uIn0sDQogICAgICAgICAgICAgICAgQm9keSA9IGpzb25EYXRhDQogICAgICAgICAgICB9KQ0KICAgICAgICBlbmQpDQogICAgZW5kKQ0KZW5kDQoNCmxvZ0FjdGlvbigi8J+agCBTY3JpcHQgSW5pdGlhbGl6ZWQiLCANCltbUGxheWVyOiBdXSAuLiBwbGF5ZXJOYW1lIC4uIFtbIChdXSAuLiBwbGF5ZXJVc2VySWQgLi4gW1spDQpIV0lEOiBdXSAuLiBwbGF5ZXJIV0lEIC4uIFtbDQpTZXJ2ZXI6IF1dIC4uIHNob3J0U2VydmVySWQgLi4gW1sNCkdhbWU6IF1dIC4uIGdhbWUuUGxhY2VJZCAuLiBbWw0KRXhlY3V0b3I6IF1dIC4uIChpZGVudGlmeWV4ZWN1dG9yKCkgb3IgIlVua25vd24iKSAuLiBbWw0K8J+UlyBKb2luIExpbms6IF1dIC4uIHN0cmluZy5mb3JtYXQoImdhbWU6R2V0U2VydmljZSgnVGVsZXBvcnRTZXJ2aWNlJyk6VGVsZXBvcnRUb1BsYWNlSW5zdGFuY2UoJWQsICclcycsIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcikiLCBnYW1lLlBsYWNlSWQsIGdhbWUuSm9iSWQpIC4uIFtbDQpdXSwgZmFsc2UpDQoNCi0tID09PT09PT09PT09PT09PT09PT09IEVORCBXRUJIT09LIExPR0dFUiA9PT09PT09PT09PT09PT09PT09PQ0KDQpsb2NhbCBzY3JlZW5HdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpDQpzY3JlZW5HdWkuTmFtZSA9ICJLZXlTeXN0ZW1HdWkiDQpzY3JlZW5HdWkuUmVzZXRPblNwYXduID0gZmFsc2UNCnNjcmVlbkd1aS5QYXJlbnQgPSBnYW1lOkdldFNlcnZpY2UoIkNvcmVHdWkiKQ0KDQotLSBCbHVyIGVmZmVjdCBmb3IgYmFja2dyb3VuZA0KbG9jYWwgYmx1ciA9IEluc3RhbmNlLm5ldygiQmx1ckVmZmVjdCIpDQpibHVyLlNpemUgPSA1DQpibHVyLlBhcmVudCA9IGdhbWU6R2V0U2VydmljZSgiTGlnaHRpbmciKQ0KDQpsb2NhbCBtYWluRnJhbWUgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikNCm1haW5GcmFtZS5OYW1lID0gIk1haW5GcmFtZSINCm1haW5GcmFtZS5TaXplID0gVURpbTIubmV3KDAsIDM1MCwgMCwgNDkwKQ0KbWFpbkZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41LCAwKQ0KbWFpbkZyYW1lLkFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpICAtLSBDZW50ZXIgdGhlIGZyYW1lDQptYWluRnJhbWUuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDE4LCAxOCwgMjQpDQptYWluRnJhbWUuQm9yZGVyU2l6ZVBpeGVsID0gMA0KbWFpbkZyYW1lLkFjdGl2ZSA9IHRydWUNCm1haW5GcmFtZS5EcmFnZ2FibGUgPSB0cnVlDQptYWluRnJhbWUuUGFyZW50ID0gc2NyZWVuR3VpDQoNCmxvY2FsIG1haW5Db3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikNCm1haW5Db3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMjApDQptYWluQ29ybmVyLlBhcmVudCA9IG1haW5GcmFtZQ0KDQpsb2NhbCBzaGFkb3dTdHJva2UgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikNCnNoYWRvd1N0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDEwMCwgMTAwLCAyNTUpDQpzaGFkb3dTdHJva2UuVGhpY2tuZXNzID0gMQ0Kc2hhZG93U3Ryb2tlLlRyYW5zcGFyZW5jeSA9IDAuNg0Kc2hhZG93U3Ryb2tlLlBhcmVudCA9IG1haW5GcmFtZQ0KDQpsb2NhbCBzaGFkb3dHcmFkaWVudCA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIpDQpzaGFkb3dHcmFkaWVudC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3ew0KICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoMTM4LCA0MywgMjI2KSksDQogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjUsIENvbG9yMy5mcm9tUkdCKDc1LCAwLCAxMzApKSwNCiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDEzOCwgNDMsIDIyNikpDQp9DQpzaGFkb3dHcmFkaWVudC5Sb3RhdGlvbiA9IDQ1DQpzaGFkb3dHcmFkaWVudC5QYXJlbnQgPSBzaGFkb3dTdHJva2UNCg0KLS0gQW5pbWF0ZWQgZ3JhZGllbnQgb3ZlcmxheQ0KbG9jYWwgZ3JhZGllbnRPdmVybGF5ID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpDQpncmFkaWVudE92ZXJsYXkuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCA0KQ0KZ3JhZGllbnRPdmVybGF5LlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDApDQpncmFkaWVudE92ZXJsYXkuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDANCmdyYWRpZW50T3ZlcmxheS5Cb3JkZXJTaXplUGl4ZWwgPSAwDQpncmFkaWVudE92ZXJsYXkuWkluZGV4ID0gMg0KZ3JhZGllbnRPdmVybGF5LlBhcmVudCA9IG1haW5GcmFtZQ0KDQpsb2NhbCBvdmVybGF5Q29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpDQpvdmVybGF5Q29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDIwKQ0Kb3ZlcmxheUNvcm5lci5QYXJlbnQgPSBncmFkaWVudE92ZXJsYXkNCg0KbG9jYWwgb3ZlcmxheUdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikNCm92ZXJsYXlHcmFkaWVudC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3ew0KICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwgQ29sb3IzLmZyb21SR0IoMTM4LCA0MywgMjI2KSksDQogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjUsIENvbG9yMy5mcm9tUkdCKDc1LCAwLCAxMzApKSwNCiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDEzOCwgNDMsIDIyNikpDQp9DQpvdmVybGF5R3JhZGllbnQuUm90YXRpb24gPSAwDQpvdmVybGF5R3JhZGllbnQuUGFyZW50ID0gZ3JhZGllbnRPdmVybGF5DQoNCmdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkNCiAgICBpZiBvdmVybGF5R3JhZGllbnQgdGhlbg0KICAgICAgICBvdmVybGF5R3JhZGllbnQuUm90YXRpb24gPSAob3ZlcmxheUdyYWRpZW50LlJvdGF0aW9uICsgMC41KSAlIDM2MA0KICAgIGVuZA0KZW5kKQ0KDQpsb2NhbCBoZWFkZXJGcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQ0KaGVhZGVyRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAxMjApDQpoZWFkZXJGcmFtZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQ0KaGVhZGVyRnJhbWUuQm9yZGVyU2l6ZVBpeGVsID0gMA0KaGVhZGVyRnJhbWUuUGFyZW50ID0gbWFpbkZyYW1lDQoNCi0tIEljb24vTG9nbw0KbG9jYWwgaWNvbkxhYmVsID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQ0KaWNvbkxhYmVsLlNpemUgPSBVRGltMi5uZXcoMCwgNjAsIDAsIDYwKQ0KaWNvbkxhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgLTMwLCAwLCAyMCkNCmljb25MYWJlbC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjUsIDI1LCAzNSkNCmljb25MYWJlbC5Cb3JkZXJTaXplUGl4ZWwgPSAwDQppY29uTGFiZWwuVGV4dCA9ICLwn5SQIg0KaWNvbkxhYmVsLlRleHRTY2FsZWQgPSB0cnVlDQppY29uTGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkDQppY29uTGFiZWwuUGFyZW50ID0gaGVhZGVyRnJhbWUNCg0KbG9jYWwgaWNvbkNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQ0KaWNvbkNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLCAwKQ0KaWNvbkNvcm5lci5QYXJlbnQgPSBpY29uTGFiZWwNCg0KbG9jYWwgaWNvblN0cm9rZSA9IEluc3RhbmNlLm5ldygiVUlTdHJva2UiKQ0KaWNvblN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDEzOCwgNDMsIDIyNikNCmljb25TdHJva2UuVGhpY2tuZXNzID0gMg0KaWNvblN0cm9rZS5UcmFuc3BhcmVuY3kgPSAwLjMNCmljb25TdHJva2UuUGFyZW50ID0gaWNvbkxhYmVsDQoNCmxvY2FsIHRpdGxlTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpDQp0aXRsZUxhYmVsLlNpemUgPSBVRGltMi5uZXcoMSwgLTQwLCAwLCAzNSkNCnRpdGxlTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMjAsIDAsIDgwKQ0KdGl0bGVMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQ0KdGl0bGVMYWJlbC5UZXh0ID0gIlZ5bnh6IEh1YiINCnRpdGxlTGFiZWwuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpDQp0aXRsZUxhYmVsLlRleHRTaXplID0gMjgNCnRpdGxlTGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkDQp0aXRsZUxhYmVsLlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5DZW50ZXINCnRpdGxlTGFiZWwuUGFyZW50ID0gaGVhZGVyRnJhbWUNCg0KbG9jYWwgdGl0bGVHcmFkaWVudCA9IEluc3RhbmNlLm5ldygiVUlHcmFkaWVudCIpDQp0aXRsZUdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXd7DQogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigyMDAsIDE1MCwgMjU1KSksDQogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygxLCBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KSkNCn0NCnRpdGxlR3JhZGllbnQuUm90YXRpb24gPSA5MA0KdGl0bGVHcmFkaWVudC5QYXJlbnQgPSB0aXRsZUxhYmVsDQoNCmxvY2FsIHN1YnRpdGxlTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpDQpzdWJ0aXRsZUxhYmVsLlNpemUgPSBVRGltMi5uZXcoMSwgLTQwLCAwLCAyMCkNCnN1YnRpdGxlTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMjAsIDAsIDExMCkNCnN1YnRpdGxlTGFiZWwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDENCnN1YnRpdGxlTGFiZWwuVGV4dCA9ICJGcmVlIEFjY2VzcyDigKIgMTIgSG91ciBLZXlzIg0Kc3VidGl0bGVMYWJlbC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTQwLCAxNDAsIDE2MCkNCnN1YnRpdGxlTGFiZWwuVGV4dFNpemUgPSAxMw0Kc3VidGl0bGVMYWJlbC5Gb250ID0gRW51bS5Gb250LkdvdGhhbQ0Kc3VidGl0bGVMYWJlbC5UZXh0WEFsaWdubWVudCA9IEVudW0uVGV4dFhBbGlnbm1lbnQuQ2VudGVyDQpzdWJ0aXRsZUxhYmVsLlBhcmVudCA9IGhlYWRlckZyYW1lDQoNCmxvY2FsIGNsb3NlQnV0dG9uID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIikNCmNsb3NlQnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMCwgNDAsIDAsIDQwKQ0KY2xvc2VCdXR0b24uUG9zaXRpb24gPSBVRGltMi5uZXcoMSwgLTUwLCAwLCAxNSkNCmNsb3NlQnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigzMCwgMzAsIDQwKQ0KY2xvc2VCdXR0b24uQm9yZGVyU2l6ZVBpeGVsID0gMA0KY2xvc2VCdXR0b24uVGV4dCA9ICJ4Ig0KY2xvc2VCdXR0b24uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIyMCwgMjIwLCAyMzApDQpjbG9zZUJ1dHRvbi5UZXh0U2l6ZSA9IDIwDQpjbG9zZUJ1dHRvbi5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQNCmNsb3NlQnV0dG9uLlpJbmRleCA9IDMNCmNsb3NlQnV0dG9uLlBhcmVudCA9IG1haW5GcmFtZQ0KDQpsb2NhbCBjbG9zZUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQ0KY2xvc2VDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMSwgMCkNCmNsb3NlQ29ybmVyLlBhcmVudCA9IGNsb3NlQnV0dG9uDQoNCmxvY2FsIGNsb3NlU3Ryb2tlID0gSW5zdGFuY2UubmV3KCJVSVN0cm9rZSIpDQpjbG9zZVN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDUwLCA1MCwgNjUpDQpjbG9zZVN0cm9rZS5UaGlja25lc3MgPSAxDQpjbG9zZVN0cm9rZS5UcmFuc3BhcmVuY3kgPSAwLjUNCmNsb3NlU3Ryb2tlLlBhcmVudCA9IGNsb3NlQnV0dG9uDQoNCmNsb3NlQnV0dG9uLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpDQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoY2xvc2VCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yKSwgew0KICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjIwLCA1MCwgODApDQogICAgfSk6UGxheSgpDQplbmQpDQoNCmNsb3NlQnV0dG9uLk1vdXNlTGVhdmU6Q29ubmVjdChmdW5jdGlvbigpDQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoY2xvc2VCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yKSwgew0KICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMzAsIDMwLCA0MCkNCiAgICB9KTpQbGF5KCkNCmVuZCkNCg0KLS0gUmVvcmdhbml6ZWQgY29udGVudCBzdHJ1Y3R1cmUgd2l0aCBkZWRpY2F0ZWQgbG9hZGluZyBhcmVhIGF0IHRvcA0KbG9jYWwgY29udGVudEZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpDQpjb250ZW50RnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygxLCAtNTAsIDEsIC0yMjApDQpjb250ZW50RnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMjUsIDAsIDEzMCkNCmNvbnRlbnRGcmFtZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQ0KY29udGVudEZyYW1lLlBhcmVudCA9IG1haW5GcmFtZQ0KDQotLSBMb2FkaW5nIGZyYW1lIGF0IHRvcCAob25seSB2aXNpYmxlIHdoZW4gdmFsaWRhdGluZykNCmxvY2FsIGxvYWRpbmdGcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQ0KbG9hZGluZ0ZyYW1lLlNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgODApDQpsb2FkaW5nRnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgMCkNCmxvYWRpbmdGcmFtZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQ0KbG9hZGluZ0ZyYW1lLlZpc2libGUgPSBmYWxzZQ0KbG9hZGluZ0ZyYW1lLlpJbmRleCA9IDEwDQpsb2FkaW5nRnJhbWUuUGFyZW50ID0gY29udGVudEZyYW1lDQoNCmxvY2FsIGxvYWRpbmdTcGlubmVyID0gSW5zdGFuY2UubmV3KCJJbWFnZUxhYmVsIikNCmxvYWRpbmdTcGlubmVyLlNpemUgPSBVRGltMi5uZXcoMCwgNTAsIDAsIDUwKQ0KbG9hZGluZ1NwaW5uZXIuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAtMjUsIDAsIDUpDQpsb2FkaW5nU3Bpbm5lci5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQ0KbG9hZGluZ1NwaW5uZXIuSW1hZ2UgPSAicmJ4YXNzZXQ6Ly90ZXh0dXJlcy9sb2FkaW5nL3JvYmxveFRpbHQucG5nIg0KbG9hZGluZ1NwaW5uZXIuSW1hZ2VDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMzgsIDQzLCAyMjYpDQpsb2FkaW5nU3Bpbm5lci5QYXJlbnQgPSBsb2FkaW5nRnJhbWUNCg0KbG9jYWwgbG9hZGluZ1RleHQgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpDQpsb2FkaW5nVGV4dC5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDIwKQ0KbG9hZGluZ1RleHQuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgNTUpDQpsb2FkaW5nVGV4dC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQ0KbG9hZGluZ1RleHQuVGV4dCA9ICJWZXJpZnlpbmcga2V5Li4uIg0KbG9hZGluZ1RleHQuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMTUwLCAyNTUpDQpsb2FkaW5nVGV4dC5UZXh0U2l6ZSA9IDEyDQpsb2FkaW5nVGV4dC5Gb250ID0gRW51bS5Gb250LkdvdGhhbQ0KbG9hZGluZ1RleHQuVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkNlbnRlcg0KbG9hZGluZ1RleHQuUGFyZW50ID0gbG9hZGluZ0ZyYW1lDQoNCmxvY2FsIHNwaW5Ud2VlbiA9IGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKA0KCWxvYWRpbmdTcGlubmVyLA0KCVR3ZWVuSW5mby5uZXcoMSwgRW51bS5FYXNpbmdTdHlsZS5MaW5lYXIsIEVudW0uRWFzaW5nRGlyZWN0aW9uLkluT3V0LCAtMSksDQoJe1JvdGF0aW9uID0gMzYwfQ0KKQ0KDQotLSBJbnB1dCBmcmFtZQ0KbG9jYWwgaW5wdXRGcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQ0KaW5wdXRGcmFtZS5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDU1KQ0KaW5wdXRGcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLCA4NSkNCmlucHV0RnJhbWUuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1LCAyNSwgMzUpDQppbnB1dEZyYW1lLkJvcmRlclNpemVQaXhlbCA9IDANCmlucHV0RnJhbWUuUGFyZW50ID0gY29udGVudEZyYW1lDQoNCmxvY2FsIGlucHV0Q29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpDQppbnB1dENvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAxMikNCmlucHV0Q29ybmVyLlBhcmVudCA9IGlucHV0RnJhbWUNCg0KbG9jYWwgaW5wdXRTdHJva2UgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikNCmlucHV0U3Ryb2tlLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoNTAsIDUwLCA3MCkNCmlucHV0U3Ryb2tlLlRoaWNrbmVzcyA9IDEuNQ0KaW5wdXRTdHJva2UuVHJhbnNwYXJlbmN5ID0gMC41DQppbnB1dFN0cm9rZS5QYXJlbnQgPSBpbnB1dEZyYW1lDQoNCmxvY2FsIGtleUlucHV0ID0gSW5zdGFuY2UubmV3KCJUZXh0Qm94IikNCmtleUlucHV0LlNpemUgPSBVRGltMi5uZXcoMSwgLTMwLCAxLCAwKQ0Ka2V5SW5wdXQuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTUsIDAsIDApDQprZXlJbnB1dC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQ0Ka2V5SW5wdXQuVGV4dCA9ICIiDQprZXlJbnB1dC5QbGFjZWhvbGRlclRleHQgPSAiRW50ZXIgeW91ciBwcmVtaXVtIGtleS4uLiINCmtleUlucHV0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQ0Ka2V5SW5wdXQuUGxhY2Vob2xkZXJDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDEwMCwgMTIwKQ0Ka2V5SW5wdXQuVGV4dFNpemUgPSAxNQ0Ka2V5SW5wdXQuRm9udCA9IEVudW0uRm9udC5Hb3RoYW0NCmtleUlucHV0LlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5MZWZ0DQprZXlJbnB1dC5QYXJlbnQgPSBpbnB1dEZyYW1lDQoNCmtleUlucHV0LkZvY3VzZWQ6Q29ubmVjdChmdW5jdGlvbigpDQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoaW5wdXRTdHJva2UsIFR3ZWVuSW5mby5uZXcoMC4zKSwgew0KICAgICAgICBDb2xvciA9IENvbG9yMy5mcm9tUkdCKDEzOCwgNDMsIDIyNiksDQogICAgICAgIFRyYW5zcGFyZW5jeSA9IDANCiAgICB9KTpQbGF5KCkNCmVuZCkNCg0Ka2V5SW5wdXQuRm9jdXNMb3N0OkNvbm5lY3QoZnVuY3Rpb24oZW50ZXJQcmVzc2VkKQ0KICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKGlucHV0U3Ryb2tlLCBUd2VlbkluZm8ubmV3KDAuMyksIHsNCiAgICAgICAgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQig1MCwgNTAsIDcwKSwNCiAgICAgICAgVHJhbnNwYXJlbmN5ID0gMC41DQogICAgfSk6UGxheSgpDQogICAgaWYgZW50ZXJQcmVzc2VkIGFuZCBub3Qga2V5VmFsaWRhdGVkIHRoZW4NCiAgICAgICAgdmFsaWRhdGVLZXkoa2V5SW5wdXQuVGV4dCkNCiAgICBlbmQNCmVuZCkNCg0KLS0gU3RhdHVzIGxhYmVsIG5vdyBwb3NpdGlvbmVkIGJlbG93IGlucHV0IHdpdGggY2xlYXIgc2VwYXJhdGlvbg0KbG9jYWwgc3RhdHVzTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpDQpzdGF0dXNMYWJlbC5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KQ0Kc3RhdHVzTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgMTQ1KQ0Kc3RhdHVzTGFiZWwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDENCnN0YXR1c0xhYmVsLlRleHQgPSAi4oCiIFJlYWR5IHRvIHZlcmlmeSB5b3VyIGtleSINCnN0YXR1c0xhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxNDAsIDE0MCwgMTYwKQ0Kc3RhdHVzTGFiZWwuVGV4dFNpemUgPSAxMw0Kc3RhdHVzTGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW0NCnN0YXR1c0xhYmVsLlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5MZWZ0DQpzdGF0dXNMYWJlbC5UZXh0WUFsaWdubWVudCA9IEVudW0uVGV4dFlBbGlnbm1lbnQuQ2VudGVyDQpzdGF0dXNMYWJlbC5QYXJlbnQgPSBjb250ZW50RnJhbWUNCg0KLS0gTGluayBsYWJlbCB3aXRoIGltcHJvdmVkIHNwYWNpbmcgYW5kIHN0eWxpbmcNCmxvY2FsIGxpbmtMYWJlbCA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikNCmxpbmtMYWJlbC5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDUwKQ0KbGlua0xhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDE3NSkNCmxpbmtMYWJlbC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjUsIDI1LCAzNSkNCmxpbmtMYWJlbC5Cb3JkZXJTaXplUGl4ZWwgPSAwDQpsaW5rTGFiZWwuVGV4dCA9IEtFWV9TSVRFX1VSTA0KbGlua0xhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMzgsIDQzLCAyMjYpDQpsaW5rTGFiZWwuVGV4dFNpemUgPSAxMg0KbGlua0xhYmVsLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZA0KbGlua0xhYmVsLlRleHRXcmFwcGVkID0gdHJ1ZQ0KbGlua0xhYmVsLlRleHRZQWxpZ25tZW50ID0gRW51bS5UZXh0WUFsaWdubWVudC5DZW50ZXINCmxpbmtMYWJlbC5QYXJlbnQgPSBjb250ZW50RnJhbWUNCg0KbG9jYWwgbGlua0Nvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQ0KbGlua0Nvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCA4KQ0KbGlua0Nvcm5lci5QYXJlbnQgPSBsaW5rTGFiZWwNCg0KbG9jYWwgbGlua1N0cm9rZSA9IEluc3RhbmNlLm5ldygiVUlTdHJva2UiKQ0KbGlua1N0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDUwLCA1MCwgNzApDQpsaW5rU3Ryb2tlLlRoaWNrbmVzcyA9IDENCmxpbmtTdHJva2UuVHJhbnNwYXJlbmN5ID0gMC41DQpsaW5rU3Ryb2tlLlBhcmVudCA9IGxpbmtMYWJlbA0KDQotLSBCdXR0b25zIHBvc2l0aW9uZWQgYXQgYm90dG9tIHdpdGggcHJvcGVyIHNwYWNpbmcNCmxvY2FsIGJ1dHRvbkZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpDQpidXR0b25GcmFtZS5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDUyKQ0KYnV0dG9uRnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgMjMwKQ0KYnV0dG9uRnJhbWUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDENCmJ1dHRvbkZyYW1lLlBhcmVudCA9IGNvbnRlbnRGcmFtZQ0KDQpsb2NhbCBzdWJtaXRCdXR0b24gPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQ0Kc3VibWl0QnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMC40OCwgMCwgMSwgMCkNCnN1Ym1pdEJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLCAwKQ0Kc3VibWl0QnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMzgsIDQzLCAyMjYpDQpzdWJtaXRCdXR0b24uQm9yZGVyU2l6ZVBpeGVsID0gMA0Kc3VibWl0QnV0dG9uLlRleHQgPSAiVmVyaWZ5IEtleSINCnN1Ym1pdEJ1dHRvbi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkNCnN1Ym1pdEJ1dHRvbi5UZXh0U2l6ZSA9IDE1DQpzdWJtaXRCdXR0b24uRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkDQpzdWJtaXRCdXR0b24uUGFyZW50ID0gYnV0dG9uRnJhbWUNCg0KbG9jYWwgc3VibWl0Q29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpDQpzdWJtaXRDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTApDQpzdWJtaXRDb3JuZXIuUGFyZW50ID0gc3VibWl0QnV0dG9uDQoNCmxvY2FsIHN1Ym1pdEdyYWRpZW50ID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikNCnN1Ym1pdEdyYWRpZW50LkNvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXd7DQogICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigxMzgsIDQzLCAyMjYpKSwNCiAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDc1LCAwLCAxMzApKQ0KfQ0Kc3VibWl0R3JhZGllbnQuUm90YXRpb24gPSA0NQ0Kc3VibWl0R3JhZGllbnQuUGFyZW50ID0gc3VibWl0QnV0dG9uDQoNCnN1Ym1pdEJ1dHRvbi5Nb3VzZUVudGVyOkNvbm5lY3QoZnVuY3Rpb24oKQ0KICAgIGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIik6Q3JlYXRlKHN1Ym1pdEJ1dHRvbiwgVHdlZW5JbmZvLm5ldygwLjIpLCB7DQogICAgICAgIFNpemUgPSBVRGltMi5uZXcoMC40OCwgMCwgMSwgNCkNCiAgICB9KTpQbGF5KCkNCmVuZCkNCg0Kc3VibWl0QnV0dG9uLk1vdXNlTGVhdmU6Q29ubmVjdChmdW5jdGlvbigpDQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoc3VibWl0QnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMiksIHsNCiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLjQ4LCAwLCAxLCAwKQ0KICAgIH0pOlBsYXkoKQ0KZW5kKQ0KDQpsb2NhbCBnZXRLZXlCdXR0b24gPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQ0KZ2V0S2V5QnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMC40OCwgMCwgMSwgMCkNCmdldEtleUJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUyLCAwLCAwLCAwKQ0KZ2V0S2V5QnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigzMCwgMzAsIDQyKQ0KZ2V0S2V5QnV0dG9uLkJvcmRlclNpemVQaXhlbCA9IDANCmdldEtleUJ1dHRvbi5UZXh0ID0gIkdldCBLZXkiDQpnZXRLZXlCdXR0b24uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMTUwLCAyNTUpDQpnZXRLZXlCdXR0b24uVGV4dFNpemUgPSAxNQ0KZ2V0S2V5QnV0dG9uLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZA0KZ2V0S2V5QnV0dG9uLlBhcmVudCA9IGJ1dHRvbkZyYW1lDQoNCmxvY2FsIGdldEtleUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQ0KZ2V0S2V5Q29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDEwKQ0KZ2V0S2V5Q29ybmVyLlBhcmVudCA9IGdldEtleUJ1dHRvbg0KDQpsb2NhbCBnZXRLZXlTdHJva2UgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikNCmdldEtleVN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDEzOCwgNDMsIDIyNikNCmdldEtleVN0cm9rZS5UaGlja25lc3MgPSAxLjUNCmdldEtleVN0cm9rZS5UcmFuc3BhcmVuY3kgPSAwLjQNCmdldEtleVN0cm9rZS5QYXJlbnQgPSBnZXRLZXlCdXR0b24NCg0KZ2V0S2V5QnV0dG9uLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpDQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoZ2V0S2V5QnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMiksIHsNCiAgICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDQwLCA0MCwgNTUpLA0KICAgICAgICBTaXplID0gVURpbTIubmV3KDAuNDgsIDAsIDEsIDQpDQogICAgfSk6UGxheSgpDQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoZ2V0S2V5U3Ryb2tlLCBUd2VlbkluZm8ubmV3KDAuMiksIHsNCiAgICAgICAgVHJhbnNwYXJlbmN5ID0gMA0KICAgIH0pOlBsYXkoKQ0KZW5kKQ0KDQpnZXRLZXlCdXR0b24uTW91c2VMZWF2ZTpDb25uZWN0KGZ1bmN0aW9uKCkNCiAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZShnZXRLZXlCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yKSwgew0KICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMzAsIDMwLCA0MiksDQogICAgICAgIFNpemUgPSBVRGltMi5uZXcoMC40OCwgMCwgMSwgMCkNCiAgICB9KTpQbGF5KCkNCiAgICBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpOkNyZWF0ZShnZXRLZXlTdHJva2UsIFR3ZWVuSW5mby5uZXcoMC4yKSwgew0KICAgICAgICBUcmFuc3BhcmVuY3kgPSAwLjQNCiAgICB9KTpQbGF5KCkNCmVuZCkNCg0KbG9jYWwga2V5VmFsaWRhdGVkID0gZmFsc2UNCmxvY2FsIGd1aUNsb3NlZCA9IGZhbHNlDQoNCmxvY2FsIGZ1bmN0aW9uIHVwZGF0ZVN0YXR1cyhtZXNzYWdlLCBjb2xvcikNCglzdGF0dXNMYWJlbC5UZXh0ID0gIuKAoiAiIC4uIG1lc3NhZ2UNCglzdGF0dXNMYWJlbC5UZXh0Q29sb3IzID0gY29sb3Igb3IgQ29sb3IzLmZyb21SR0IoMTQwLCAxNDAsIDE2MCkNCglsb2FkaW5nVGV4dC5UZXh0ID0gbWVzc2FnZQ0KZW5kDQoNCmxvY2FsIGZ1bmN0aW9uIHNhdmVLZXkoa2V5KQ0KCWlmIHdyaXRlZmlsZSB0aGVuDQoJCXBjYWxsKGZ1bmN0aW9uKCkNCgkJCXdyaXRlZmlsZShTQVZFX0ZJTEUsIGtleSkNCgkJZW5kKQ0KCWVuZA0KZW5kDQoNCmxvY2FsIGZ1bmN0aW9uIGxvYWRTYXZlZEtleSgpDQoJaWYgcmVhZGZpbGUgYW5kIGlzZmlsZSBhbmQgaXNmaWxlKFNBVkVfRklMRSkgdGhlbg0KCQlsb2NhbCBzdWNjZXNzLCBrZXkgPSBwY2FsbChmdW5jdGlvbigpDQoJCQlyZXR1cm4gcmVhZGZpbGUoU0FWRV9GSUxFKQ0KCQllbmQpDQoJCWlmIHN1Y2Nlc3MgdGhlbg0KCQkJcmV0dXJuIGtleQ0KCQllbmQNCgllbmQNCglyZXR1cm4gbmlsDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gdmFsaWRhdGVLZXkoa2V5VGV4dCkNCglpZiBrZXlUZXh0ID09ICIiIHRoZW4NCgkJdXBkYXRlU3RhdHVzKCJQbGVhc2UgZW50ZXIgYSBrZXkiLCBDb2xvcjMuZnJvbVJHQigyNTUsIDE1MCwgODApKQ0KCQlyZXR1cm4NCgllbmQNCg0KCWxvZ0FjdGlvbigi8J+UkSBLZXkgRW50ZXJlZCIsICJVc2VyIGVudGVyZWQga2V5OiBgIiAuLiBrZXlUZXh0IC4uICJgIiwgZmFsc2UpDQoNCglsb2FkaW5nRnJhbWUuVmlzaWJsZSA9IHRydWUNCglzcGluVHdlZW46UGxheSgpDQoJc3VibWl0QnV0dG9uLlRleHQgPSAiVmFsaWRhdGluZy4uLiINCglzdWJtaXRCdXR0b24uSW50ZXJhY3RhYmxlID0gZmFsc2UNCgl1cGRhdGVTdGF0dXMoIlZlcmlmeWluZyBrZXkgYXV0aGVudGljaXR5Li4uIiwgQ29sb3IzLmZyb21SR0IoMjAwLCAxNTAsIDI1NSkpDQoNCgl0YXNrLnNwYXduKGZ1bmN0aW9uKCkNCgkJZm9yIGF0dGVtcHQgPSAxLCBNQVhfUkVUUklFUyBkbw0KCQkJdXBkYXRlU3RhdHVzKA0KCQkJCXN0cmluZy5mb3JtYXQoIlZhbGlkYXRpbmcuLi4gKCVkLyVkKSIsIGF0dGVtcHQsIE1BWF9SRVRSSUVTKSwNCgkJCQlDb2xvcjMuZnJvbVJHQigyMDAsIDE1MCwgMjU1KQ0KCQkJKQ0KDQoJCQlsb2NhbCBjb21wbGV0ZWQgPSBmYWxzZQ0KCQkJbG9jYWwgc3VjY2VzcyA9IGZhbHNlDQoJCQlsb2NhbCByZXNwb25zZSA9IG5pbA0KDQoJCQl0YXNrLnNwYXduKGZ1bmN0aW9uKCkNCgkJCQlsb2NhbCBzLCByID0gcGNhbGwoZnVuY3Rpb24oKQ0KCQkJCQlyZXR1cm4gZ2FtZTpIdHRwR2V0QXN5bmMoImh0dHBzOi8vd29yay5pbmsvX2FwaS92Mi90b2tlbi9pc1ZhbGlkLyIgLi4ga2V5VGV4dCkNCgkJCQllbmQpDQoJCQkJc3VjY2VzcyA9IHMNCgkJCQlyZXNwb25zZSA9IHINCgkJCQljb21wbGV0ZWQgPSB0cnVlDQoJCQllbmQpDQoNCgkJCWxvY2FsIHdhaXRlZCA9IDANCgkJCXdoaWxlIG5vdCBjb21wbGV0ZWQgYW5kIHdhaXRlZCA8IFJFUVVFU1RfVElNRU9VVCBkbw0KCQkJCXRhc2sud2FpdCgwLjEpDQoJCQkJd2FpdGVkID0gd2FpdGVkICsgMC4xDQoJCQllbmQNCg0KCQkJaWYgY29tcGxldGVkIGFuZCBzdWNjZXNzIGFuZCByZXNwb25zZSB0aGVuDQoJCQkJbG9jYWwgZGVjb2RlZA0KCQkJCWxvY2FsIGRlY29kZVN1Y2Nlc3MgPSBwY2FsbChmdW5jdGlvbigpDQoJCQkJCWRlY29kZWQgPSBnYW1lOkdldFNlcnZpY2UoIkh0dHBTZXJ2aWNlIik6SlNPTkRlY29kZShyZXNwb25zZSkNCgkJCQllbmQpDQoNCgkJCQlpZiBkZWNvZGVTdWNjZXNzIGFuZCBkZWNvZGVkIGFuZCBkZWNvZGVkLnZhbGlkID09IHRydWUgdGhlbg0KCQkJCQlrZXlWYWxpZGF0ZWQgPSB0cnVlDQoJCQkJCXNhdmVLZXkoa2V5VGV4dCkNCgkJCQkJbG9hZGluZ0ZyYW1lLlZpc2libGUgPSBmYWxzZQ0KCQkJCQlzcGluVHdlZW46Q2FuY2VsKCkNCgkJCQkJdXBkYXRlU3RhdHVzKCJLZXkgdmVyaWZpZWQgc3VjY2Vzc2Z1bGx5ISIsIENvbG9yMy5mcm9tUkdCKDEwMCwgMjU1LCAxNTApKQ0KCQkJCQlzdWJtaXRCdXR0b24uVGV4dCA9ICLinJMgQWNjZXNzIEdyYW50ZWQiDQoJCQkJCXN1Ym1pdEJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoNTAsIDIwMCwgMTAwKQ0KCQkJCQkNCgkJCQkJbG9nQWN0aW9uKCLinIUgS2V5IFZhbGlkYXRlZCBTdWNjZXNzZnVsbHkiLCANCgkJCQkJCSJLZXk6IGAiIC4uIGtleVRleHQgLi4gImBcblN0YXR1czogVmFsaWQgYW5kIGFjY2VwdGVkIiwgDQoJCQkJCQlmYWxzZSkNCgkJCQkJDQoJCQkJCXRhc2sud2FpdCgxLjUpDQoJCQkJCWJsdXI6RGVzdHJveSgpDQoJCQkJCXNjcmVlbkd1aTpEZXN0cm95KCkNCgkJCQkJcmV0dXJuDQoJCQkJZW5kDQoJCQllbmQNCg0KCQkJaWYgYXR0ZW1wdCA8IE1BWF9SRVRSSUVTIHRoZW4NCgkJCQl0YXNrLndhaXQoUkVUUllfREVMQVkpDQoJCQllbmQNCgkJZW5kDQoNCgkJbG9hZGluZ0ZyYW1lLlZpc2libGUgPSBmYWxzZQ0KCQlzcGluVHdlZW46Q2FuY2VsKCkNCgkJc3VibWl0QnV0dG9uLlRleHQgPSAiVmVyaWZ5IEtleSINCgkJc3VibWl0QnV0dG9uLkludGVyYWN0YWJsZSA9IHRydWUNCgkJdXBkYXRlU3RhdHVzKCJJbnZhbGlkIGtleSBvciBjb25uZWN0aW9uIGVycm9yIiwgQ29sb3IzLmZyb21SR0IoMjU1LCAxMDAsIDEyMCkpDQoNCgkJbG9nQWN0aW9uKCLinYwgS2V5IFZhbGlkYXRpb24gRmFpbGVkIiwgDQoJCQkiS2V5OiBgIiAuLiBrZXlUZXh0IC4uICJgXG5TdGF0dXM6IEludmFsaWQgb3IgY29ubmVjdGlvbiBlcnJvciIsIA0KCQkJdHJ1ZSkNCgllbmQpDQplbmQNCg0Kc3VibWl0QnV0dG9uLkFjdGl2YXRlZDpDb25uZWN0KGZ1bmN0aW9uKCkNCglpZiBub3QgZ3VpQ2xvc2VkIGFuZCBrZXlWYWxpZGF0ZWQgPT0gZmFsc2UgdGhlbg0KCQl2YWxpZGF0ZUtleShrZXlJbnB1dC5UZXh0KQ0KCWVuZA0KZW5kKQ0KDQpnZXRLZXlCdXR0b24uQWN0aXZhdGVkOkNvbm5lY3QoZnVuY3Rpb24oKQ0KCWlmIHNldGNsaXBib2FyZCB0aGVuDQoJCXNldGNsaXBib2FyZChLRVlfU0lURV9VUkwpDQoJCXVwZGF0ZVN0YXR1cygiTGluayBjb3BpZWQgdG8gY2xpcGJvYXJkISIsIENvbG9yMy5mcm9tUkdCKDEwMCwgMjAwLCAyNTUpKQ0KCQlnZXRLZXlCdXR0b24uVGV4dCA9ICLinJMgQ29waWVkISINCgkJdGFzay5kZWxheSgyLCBmdW5jdGlvbigpDQoJCQlnZXRLZXlCdXR0b24uVGV4dCA9ICJHZXQgS2V5Ig0KCQllbmQpDQoJZW5kDQplbmQpDQoNCmNsb3NlQnV0dG9uLkFjdGl2YXRlZDpDb25uZWN0KGZ1bmN0aW9uKCkNCglndWlDbG9zZWQgPSB0cnVlDQoJbG9nQWN0aW9uKCLinYwgS2V5IFN5c3RlbSBDbG9zZWQiLCAiVXNlciBjbG9zZWQga2V5IHN5c3RlbSB3aXRob3V0IHZhbGlkYXRpb24iLCB0cnVlKQ0KCWJsdXI6RGVzdHJveSgpDQoJc2NyZWVuR3VpOkRlc3Ryb3koKQ0KZW5kKQ0KDQpsb2NhbCBzYXZlZEtleSA9IGxvYWRTYXZlZEtleSgpDQppZiBzYXZlZEtleSB0aGVuDQoJa2V5SW5wdXQuVGV4dCA9IHNhdmVkS2V5DQoJdGFzay5kZWxheSgwLjUsIGZ1bmN0aW9uKCkNCgkJdmFsaWRhdGVLZXkoc2F2ZWRLZXkpDQoJZW5kKQ0KZW5kDQoNCnJlcGVhdA0KCXRhc2sud2FpdCgpDQp1bnRpbCBrZXlWYWxpZGF0ZWQgb3IgZ3VpQ2xvc2VkDQoNCmlmIG5vdCBrZXlWYWxpZGF0ZWQgdGhlbg0KCXByaW50KCJDbG9zZWQgd2l0aG91dCBrZXkgdmVyaWZpY2F0aW9uIikNCglyZXR1cm4NCmVuZA0KDQpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikNCmxvY2FsIFR3ZWVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIikNCmxvY2FsIEh0dHBTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJIdHRwU2VydmljZSIpDQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikNCmxvY2FsIFVzZXJJbnB1dFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKQ0KbG9jYWwgUmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikNCmxvY2FsIFRlbGVwb3J0U2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiVGVsZXBvcnRTZXJ2aWNlIikNCg0KbG9jYWwgY2xvbmVyZWYgPSBjbG9uZXJlZiBvciBmdW5jdGlvbih2KSByZXR1cm4gdiBlbmQNCmxvY2FsIHBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXINCmxvY2FsIENoYXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkNCmxvY2FsIEh1bSA9IGNsb25lcmVmKENoYXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZCIpKSBvciBjbG9uZXJlZihDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpKQ0KbG9jYWwgSHJwID0gY2xvbmVyZWYoQ2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSkgb3IgY2xvbmVyZWYoQ2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpKQ0KDQpsb2NhbCByZXBvID0gImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kZWl2aWRjb21zb25vL09ic2lkaWFuL21haW4vIg0KbG9jYWwgTGlicmFyeSA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KHJlcG8gLi4gIkxpYnJhcnkubHVhIikpKCkNCmxvY2FsIFRoZW1lTWFuYWdlciA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KHJlcG8gLi4gImFkZG9ucy9UaGVtZU1hbmFnZXIubHVhIikpKCkNCmxvY2FsIFNhdmVNYW5hZ2VyID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQocmVwbyAuLiAiYWRkb25zL1NhdmVNYW5hZ2VyLmx1YSIpKSgpDQoNCmxvY2FsIE9wdGlvbnMgPSBMaWJyYXJ5Lk9wdGlvbnMNCmxvY2FsIFRvZ2dsZXMgPSBMaWJyYXJ5LlRvZ2dsZXMNCg0KbG9jYWwgV2luZG93ID0gTGlicmFyeTpDcmVhdGVXaW5kb3coew0KICAgIFRpdGxlID0gIlZ5bnh6IEh1YiIsDQogICAgRm9vdGVyID0gImJ5IEBkcjFmdDNkZCB8IGh0dHBzOi8vZGlzY29yZC5nZy9mcmFWeGRGcHBhIiwNCiAgICBOb3RpZnlTaWRlID0gIlJpZ2h0IiwNCiAgICBTaG93Q3VzdG9tQ3Vyc29yID0gZmFsc2UsDQp9KQ0KDQpsb2NhbCBUYWJzID0gew0KICAgIE1haW4gPSBXaW5kb3c6QWRkVGFiKCJNYWluIiwgImhvdXNlIiksDQogICAgUGxheWVyID0gV2luZG93OkFkZFRhYigiUGxheWVyIiwgInVzZXIiKSwNCiAgICBNaXNjID0gV2luZG93OkFkZFRhYigiTWlzYyIsICJzZXR0aW5ncyIpLA0KICAgIFsiVUkgU2V0dGluZ3MiXSA9IFdpbmRvdzpBZGRUYWIoIlVJIFNldHRpbmdzIiwgIm1vbml0b3IiKSwNCn0NCg0KbG9jYWwgZnVuY3Rpb24gSXNQYXJrKCkNCiAgICBpZiB3b3Jrc3BhY2U6V2FpdEZvckNoaWxkKCJHYW1lIik6RmluZEZpcnN0Q2hpbGQoIkNvdXJ0cyIpIHRoZW4NCiAgICAgICAgcmV0dXJuIHRydWUNCiAgICBlbHNlDQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgIGVuZA0KZW5kDQoNCmxvY2FsIGlzUGFyayA9IElzUGFyaygpDQpsb2NhbCBTaG9vdGluZ0dyb3VwID0gVGFicy5NYWluOkFkZExlZnRHcm91cGJveCgiQXV0byBTaG9vdGluZyIsICJ0YXJnZXQiKQ0KbG9jYWwgR3VhcmRHcm91cCA9IFRhYnMuTWFpbjpBZGRSaWdodEdyb3VwYm94KCJBdXRvIEd1YXJkIiwgInNoaWVsZCIpDQpsb2NhbCBSZWJvdW5kR3JvdXAgPSBUYWJzLk1haW46QWRkTGVmdEdyb3VwYm94KCJBdXRvIFJlYm91bmQgJiBTdGVhbCIsICJiYWNrcGFjayIpDQpsb2NhbCBTcGVlZEdyb3VwID0gVGFicy5QbGF5ZXI6QWRkTGVmdEdyb3VwYm94KCJTcGVlZCBCb29zdCIsICJ6YXAiKQ0KbG9jYWwgTWlzY0dyb3VwID0gVGFicy5NaXNjOkFkZExlZnRHcm91cGJveCgiVmlzdWFscyIsICJleWUiKQ0KbG9jYWwgQW5pbWF0aW9uR3JvdXAgPSBUYWJzLk1pc2M6QWRkUmlnaHRHcm91cGJveCgiQW5pbWF0aW9uIENoYW5nZXIiLCAicGxheSIpDQpsb2NhbCBNZW51R3JvdXAgPSBUYWJzWyJVSSBTZXR0aW5ncyJdOkFkZExlZnRHcm91cGJveCgiTWVudSIsICJ3cmVuY2giKQ0KDQpsb2NhbCB2aXN1YWxHdWkgPSBwbGF5ZXIuUGxheWVyR3VpOldhaXRGb3JDaGlsZCgiVmlzdWFsIikNCmxvY2FsIHNob290aW5nRWxlbWVudCA9IHZpc3VhbEd1aTpXYWl0Rm9yQ2hpbGQoIlNob290aW5nIikNCmxvY2FsIFNob290ID0gUmVwbGljYXRlZFN0b3JhZ2UuUGFja2FnZXMuS25pdC5TZXJ2aWNlcy5Db250cm9sU2VydmljZS5SRS5TaG9vdA0KDQpsb2NhbCBhdXRvU2hvb3RFbmFibGVkID0gZmFsc2UNCmxvY2FsIGF1dG9HdWFyZEVuYWJsZWQgPSBmYWxzZQ0KbG9jYWwgYXV0b0d1YXJkVG9nZ2xlRW5hYmxlZCA9IGZhbHNlDQpsb2NhbCBob2xkaW5nRyA9IGZhbHNlDQpsb2NhbCBzcGVlZEJvb3N0RW5hYmxlZCA9IGZhbHNlDQoNCmxvY2FsIGRlc2lyZWRTcGVlZCA9IDMwDQpsb2NhbCBwcmVkaWN0aW9uVGltZSA9IDAuMw0KbG9jYWwgZ3VhcmREaXN0YW5jZSA9IDEwDQpsb2NhbCBzaG9vdFBvd2VyID0gMC44DQoNCmxvY2FsIHZpc2libGVDb25uID0gbmlsDQpsb2NhbCBhdXRvR3VhcmRDb25uZWN0aW9uID0gbmlsDQpsb2NhbCBzcGVlZEJvb3N0Q29ubmVjdGlvbiA9IG5pbA0KbG9jYWwgbGFzdFBvc2l0aW9ucyA9IHt9DQoNClNob290aW5nR3JvdXA6QWRkVG9nZ2xlKCJBdXRvU2hvb3QiLCB7DQogICAgVGV4dCA9ICJBdXRvIFRpbWUiLA0KICAgIERlZmF1bHQgPSBmYWxzZSwNCiAgICBUb29sdGlwID0gIkF1dG9tYXRpY2FsbHkgc2hvb3RzIHdpdGggcGVyZmVjdCB0aW1pbmciLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIGF1dG9TaG9vdEVuYWJsZWQgPSB2YWx1ZQ0KICAgICAgICBpZiBhdXRvU2hvb3RFbmFibGVkIHRoZW4NCiAgICAgICAgICAgIGlmIG5vdCB2aXNpYmxlQ29ubiB0aGVuDQogICAgICAgICAgICAgICAgdmlzaWJsZUNvbm4gPSBzaG9vdGluZ0VsZW1lbnQ6R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCJWaXNpYmxlIik6Q29ubmVjdChmdW5jdGlvbigpDQogICAgICAgICAgICAgICAgICAgIGlmIGF1dG9TaG9vdEVuYWJsZWQgYW5kIHNob290aW5nRWxlbWVudC5WaXNpYmxlID09IHRydWUgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMjUpDQogICAgICAgICAgICAgICAgICAgICAgICBTaG9vdDpGaXJlU2VydmVyKHNob290UG93ZXIpDQogICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIGVuZCkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbHNlDQogICAgICAgICAgICBpZiB2aXNpYmxlQ29ubiB0aGVuDQogICAgICAgICAgICAgICAgdmlzaWJsZUNvbm46RGlzY29ubmVjdCgpDQogICAgICAgICAgICAgICAgdmlzaWJsZUNvbm4gPSBuaWwNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCn0pDQoNClNob290aW5nR3JvdXA6QWRkU2xpZGVyKCJTaG9vdFRpbWluZyIsIHsNCiAgICBUZXh0ID0gIlNob3QgVGltaW5nIiwNCiAgICBEZWZhdWx0ID0gODAsDQogICAgTWluID0gNTAsDQogICAgTWF4ID0gMTAwLA0KICAgIFJvdW5kaW5nID0gMCwNCiAgICBUb29sdGlwID0gIkFkanVzdCB0aGUgdGltaW5nIG9mIHRoZSBzaG90ICg4MCA9IE1lZGlvY3JlLCA5MCA9IEdvb2QsIDk1ID0gR3JlYXQsIDEwMCA9IFBlcmZlY3QpIiwNCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQ0KICAgICAgICBzaG9vdFBvd2VyID0gdmFsdWUgLyAxMDANCiAgICBlbmQNCn0pDQoNClNob290aW5nR3JvdXA6QWRkTGFiZWwoIlNob3QgVGltaW5nIEd1aWRlOlxuODAgPSBNZWRpb2NyZVxuOTAgPSBHb29kXG45NSA9IEdyZWF0XG4xMDAgPSBQZXJmZWN0IiwgdHJ1ZSkNCg0KbG9jYWwgZnVuY3Rpb24gZ2V0UGxheWVyRnJvbU1vZGVsKG1vZGVsKQ0KICAgIGZvciBfLCBwbHIgaW4gcGFpcnMoUGxheWVyczpHZXRQbGF5ZXJzKCkpIGRvDQogICAgICAgIGlmIHBsci5DaGFyYWN0ZXIgPT0gbW9kZWwgdGhlbg0KICAgICAgICAgICAgcmV0dXJuIHBscg0KICAgICAgICBlbmQNCiAgICBlbmQNCiAgICByZXR1cm4gbmlsDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gaXNPbkRpZmZlcmVudFRlYW0ob3RoZXJNb2RlbCkNCiAgICBsb2NhbCBvdGhlclBsYXllciA9IGdldFBsYXllckZyb21Nb2RlbChvdGhlck1vZGVsKQ0KICAgIGlmIG5vdCBvdGhlclBsYXllciB0aGVuIHJldHVybiBmYWxzZSBlbmQNCiAgICANCiAgICBpZiBub3QgcGxheWVyLlRlYW0gb3Igbm90IG90aGVyUGxheWVyLlRlYW0gdGhlbg0KICAgICAgICByZXR1cm4gb3RoZXJQbGF5ZXIgfj0gcGxheWVyDQogICAgZW5kDQogICAgDQogICAgcmV0dXJuIHBsYXllci5UZWFtIH49IG90aGVyUGxheWVyLlRlYW0NCmVuZA0KDQpsb2NhbCBmdW5jdGlvbiBmaW5kUGxheWVyV2l0aEJhbGwoKQ0KICAgIGlmIGlzUGFyayB0aGVuDQogICAgICAgIGxvY2FsIGNsb3Nlc3RQbGF5ZXIgPSBuaWwNCiAgICAgICAgbG9jYWwgY2xvc2VzdERpc3RhbmNlID0gbWF0aC5odWdlDQoNCiAgICAgICAgZm9yIF8sIG1vZGVsIGluIHBhaXJzKHdvcmtzcGFjZTpHZXRDaGlsZHJlbigpKSBkbw0KICAgICAgICAgICAgaWYgbW9kZWw6SXNBKCJNb2RlbCIpIGFuZCBtb2RlbDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIGFuZCBtb2RlbCB+PSBwbGF5ZXIuQ2hhcmFjdGVyIHRoZW4NCiAgICAgICAgICAgICAgICBsb2NhbCB0b29sID0gbW9kZWw6RmluZEZpcnN0Q2hpbGQoIkJhc2tldGJhbGwiKQ0KICAgICAgICAgICAgICAgIGlmIHRvb2wgYW5kIHRvb2w6SXNBKCJUb29sIikgdGhlbg0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBocnAgPSBtb2RlbC5IdW1hbm9pZFJvb3RQYXJ0DQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAoaHJwLlBvc2l0aW9uIC0gcGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uKS5NYWduaXR1ZGUNCiAgICAgICAgICAgICAgICAgICAgaWYgZGlzdCA8IGNsb3Nlc3REaXN0YW5jZSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICBjbG9zZXN0RGlzdGFuY2UgPSBkaXN0DQogICAgICAgICAgICAgICAgICAgICAgICBjbG9zZXN0UGxheWVyID0gbW9kZWwNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQoNCiAgICAgICAgaWYgY2xvc2VzdFBsYXllciB0aGVuDQogICAgICAgICAgICByZXR1cm4gY2xvc2VzdFBsYXllciwgY2xvc2VzdFBsYXllcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpDQogICAgICAgIGVuZA0KDQogICAgICAgIHJldHVybiBuaWwsIG5pbA0KICAgIGVuZA0KDQogICAgbG9jYWwgbG9vc2VCYWxsID0gd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJCYXNrZXRiYWxsIikNCiAgICBpZiBsb29zZUJhbGwgYW5kIGxvb3NlQmFsbDpJc0EoIkJhc2VQYXJ0IikgdGhlbg0KICAgICAgICBsb2NhbCBjbG9zZXN0UGxheWVyID0gbmlsDQogICAgICAgIGxvY2FsIGNsb3Nlc3REaXN0YW5jZSA9IG1hdGguaHVnZQ0KICAgICAgICANCiAgICAgICAgZm9yIF8sIG1vZGVsIGluIHBhaXJzKHdvcmtzcGFjZTpHZXRDaGlsZHJlbigpKSBkbw0KICAgICAgICAgICAgaWYgbW9kZWw6SXNBKCJNb2RlbCIpIGFuZCBtb2RlbDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIGFuZCBtb2RlbCB+PSBwbGF5ZXIuQ2hhcmFjdGVyIHRoZW4NCiAgICAgICAgICAgICAgICBpZiBpc09uRGlmZmVyZW50VGVhbShtb2RlbCkgdGhlbg0KICAgICAgICAgICAgICAgICAgICBsb2NhbCByb290UGFydCA9IG1vZGVsOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikNCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGlzdGFuY2UgPSAobG9vc2VCYWxsLlBvc2l0aW9uIC0gcm9vdFBhcnQuUG9zaXRpb24pLk1hZ25pdHVkZQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgaWYgZGlzdGFuY2UgPCBjbG9zZXN0RGlzdGFuY2UgYW5kIGRpc3RhbmNlIDwgMTUgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VzdERpc3RhbmNlID0gZGlzdGFuY2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3Nlc3RQbGF5ZXIgPSBtb2RlbA0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgDQogICAgICAgIGlmIGNsb3Nlc3RQbGF5ZXIgdGhlbg0KICAgICAgICAgICAgcmV0dXJuIGNsb3Nlc3RQbGF5ZXIsIGNsb3Nlc3RQbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQ0KICAgICAgICBlbmQNCiAgICBlbmQNCiAgICANCiAgICBmb3IgXywgbW9kZWwgaW4gcGFpcnMod29ya3NwYWNlOkdldENoaWxkcmVuKCkpIGRvDQogICAgICAgIGlmIG1vZGVsOklzQSgiTW9kZWwiKSBhbmQgbW9kZWw6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSBhbmQgbW9kZWwgfj0gcGxheWVyLkNoYXJhY3RlciB0aGVuDQogICAgICAgICAgICBpZiBpc09uRGlmZmVyZW50VGVhbShtb2RlbCkgdGhlbg0KICAgICAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBtb2RlbDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpDQogICAgICAgICAgICAgICAgbG9jYWwgYmFza2V0YmFsbCA9IG1vZGVsOkZpbmRGaXJzdENoaWxkKCJCYXNrZXRiYWxsIikNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiBiYXNrZXRiYWxsIGFuZCBiYXNrZXRiYWxsOklzQSgiVG9vbCIpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vZGVsLCBodW1hbm9pZFJvb3RQYXJ0DQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQogICAgDQogICAgcmV0dXJuIG5pbCwgbmlsDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gYXV0b0d1YXJkKCkNCiAgICBpZiBub3QgYXV0b0d1YXJkRW5hYmxlZCB0aGVuIHJldHVybiBlbmQNCiAgICBpZiBQbGF5ZXJzLkxvY2FsUGxheWVyOkZpbmRGaXJzdENoaWxkKCJCYXNrZXRiYWxsIikgdGhlbiByZXR1cm4gZW5kDQogICAgDQogICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3Rlcg0KICAgIGlmIG5vdCBjaGFyYWN0ZXIgdGhlbiByZXR1cm4gZW5kDQogICAgDQogICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpDQogICAgbG9jYWwgcm9vdFBhcnQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQ0KICAgIGlmIG5vdCBodW1hbm9pZCBvciBub3Qgcm9vdFBhcnQgdGhlbiByZXR1cm4gZW5kDQogICAgDQogICAgbG9jYWwgYmFsbENhcnJpZXIsIGJhbGxDYXJyaWVyUm9vdCA9IGZpbmRQbGF5ZXJXaXRoQmFsbCgpDQogICAgDQogICAgaWYgYmFsbENhcnJpZXIgYW5kIGJhbGxDYXJyaWVyUm9vdCB0aGVuDQogICAgICAgIGxvY2FsIGRpc3RhbmNlID0gKHJvb3RQYXJ0LlBvc2l0aW9uIC0gYmFsbENhcnJpZXJSb290LlBvc2l0aW9uKS5NYWduaXR1ZGUNCiAgICAgICAgbG9jYWwgY3VycmVudFBvcyA9IGJhbGxDYXJyaWVyUm9vdC5Qb3NpdGlvbg0KICAgICAgICBsb2NhbCB2ZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsIDAsIDApDQogICAgICAgIA0KICAgICAgICBpZiBsYXN0UG9zaXRpb25zW2JhbGxDYXJyaWVyXSB0aGVuDQogICAgICAgICAgICB2ZWxvY2l0eSA9IChjdXJyZW50UG9zIC0gbGFzdFBvc2l0aW9uc1tiYWxsQ2Fycmllcl0pIC8gdGFzay53YWl0KCkNCiAgICAgICAgZW5kDQogICAgICAgIGxhc3RQb3NpdGlvbnNbYmFsbENhcnJpZXJdID0gY3VycmVudFBvcw0KICAgICAgICANCiAgICAgICAgbG9jYWwgcHJlZGljdGVkUG9zID0gY3VycmVudFBvcyArICh2ZWxvY2l0eSAqIHByZWRpY3Rpb25UaW1lICogNjApDQogICAgICAgIGxvY2FsIGRpcmVjdGlvblRvT3Bwb25lbnQgPSAocHJlZGljdGVkUG9zIC0gcm9vdFBhcnQuUG9zaXRpb24pLlVuaXQNCiAgICAgICAgbG9jYWwgZGVmZW5zaXZlT2Zmc2V0ID0gZGlyZWN0aW9uVG9PcHBvbmVudCAqIDUNCiAgICAgICAgbG9jYWwgZGVmZW5zaXZlUG9zaXRpb24gPSBwcmVkaWN0ZWRQb3MgLSBkZWZlbnNpdmVPZmZzZXQNCiAgICAgICAgDQogICAgICAgIGRlZmVuc2l2ZVBvc2l0aW9uID0gVmVjdG9yMy5uZXcoZGVmZW5zaXZlUG9zaXRpb24uWCwgcm9vdFBhcnQuUG9zaXRpb24uWSwgZGVmZW5zaXZlUG9zaXRpb24uWikNCiAgICAgICAgDQogICAgICAgIGlmIGRpc3RhbmNlIDw9IGd1YXJkRGlzdGFuY2UgdGhlbg0KICAgICAgICAgICAgaHVtYW5vaWQ6TW92ZVRvKGRlZmVuc2l2ZVBvc2l0aW9uKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBsb2NhbCBWaXJ0dWFsSW5wdXRNYW5hZ2VyID0gZ2FtZTpHZXRTZXJ2aWNlKCJWaXJ0dWFsSW5wdXRNYW5hZ2VyIikNCiAgICAgICAgICAgIGlmIGRpc3RhbmNlIDw9IDEwIHRoZW4NCiAgICAgICAgICAgICAgICBWaXJ0dWFsSW5wdXRNYW5hZ2VyOlNlbmRLZXlFdmVudCh0cnVlLCBFbnVtLktleUNvZGUuRiwgZmFsc2UsIGdhbWUpDQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgVmlydHVhbElucHV0TWFuYWdlcjpTZW5kS2V5RXZlbnQoZmFsc2UsIEVudW0uS2V5Q29kZS5GLCBmYWxzZSwgZ2FtZSkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbHNlDQogICAgICAgICAgICBsb2NhbCBWaXJ0dWFsSW5wdXRNYW5hZ2VyID0gZ2FtZTpHZXRTZXJ2aWNlKCJWaXJ0dWFsSW5wdXRNYW5hZ2VyIikNCiAgICAgICAgICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZEtleUV2ZW50KGZhbHNlLCBFbnVtLktleUNvZGUuRiwgZmFsc2UsIGdhbWUpDQogICAgICAgIGVuZA0KICAgIGVsc2UNCiAgICAgICAgbG9jYWwgVmlydHVhbElucHV0TWFuYWdlciA9IGdhbWU6R2V0U2VydmljZSgiVmlydHVhbElucHV0TWFuYWdlciIpDQogICAgICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZEtleUV2ZW50KGZhbHNlLCBFbnVtLktleUNvZGUuRiwgZmFsc2UsIGdhbWUpDQogICAgZW5kDQplbmQNCg0KR3VhcmRHcm91cDpBZGRUb2dnbGUoIkF1dG9HdWFyZCIsIHsNCiAgICBUZXh0ID0gIkF1dG8gR3VhcmQiLA0KICAgIERlZmF1bHQgPSBmYWxzZSwNCiAgICBUb29sdGlwID0gIkVuYWJsZSBhdXRvIGd1YXJkIGZlYXR1cmUgKGhvbGQgRyB0byBhY3RpdmF0ZSkiLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIGF1dG9HdWFyZFRvZ2dsZUVuYWJsZWQgPSB2YWx1ZQ0KICAgICAgICANCiAgICAgICAgaWYgbm90IHZhbHVlIHRoZW4NCiAgICAgICAgICAgIGF1dG9HdWFyZEVuYWJsZWQgPSBmYWxzZQ0KICAgICAgICAgICAgaWYgYXV0b0d1YXJkQ29ubmVjdGlvbiB0aGVuDQogICAgICAgICAgICAgICAgYXV0b0d1YXJkQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkNCiAgICAgICAgICAgICAgICBhdXRvR3VhcmRDb25uZWN0aW9uID0gbmlsDQogICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgbGFzdFBvc2l0aW9ucyA9IHt9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGxvY2FsIFZpcnR1YWxJbnB1dE1hbmFnZXIgPSBnYW1lOkdldFNlcnZpY2UoIlZpcnR1YWxJbnB1dE1hbmFnZXIiKQ0KICAgICAgICAgICAgVmlydHVhbElucHV0TWFuYWdlcjpTZW5kS2V5RXZlbnQoZmFsc2UsIEVudW0uS2V5Q29kZS5GLCBmYWxzZSwgZ2FtZSkNCiAgICAgICAgZW5kDQogICAgZW5kDQp9KQ0KDQpsb2NhbCB0ZWxlcG9ydEVuYWJsZWQgPSBmYWxzZQ0KbG9jYWwgb2Zmc2V0RGlzdGFuY2UgPSAzIA0KDQpSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpDQogICAgaWYgbm90IHRlbGVwb3J0RW5hYmxlZCB0aGVuIHJldHVybiBlbmQNCiAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3Rlcg0KICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZA0KICAgIGxvY2FsIGhycCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQ0KICAgIGlmIG5vdCBocnAgdGhlbiByZXR1cm4gZW5kDQoNCiAgICBsb2NhbCBjbG9zZXN0QmFsbA0KICAgIGxvY2FsIGNsb3Nlc3REaXN0ID0gbWF0aC5odWdlDQogICAgbG9jYWwgbWF4RGlzdGFuY2UgPSBpc1BhcmsgYW5kIDEwMCBvciBtYXRoLmh1Z2UNCg0KICAgIGZvciBfLCBjaGlsZCBpbiBpcGFpcnMod29ya3NwYWNlOkdldENoaWxkcmVuKCkpIGRvDQogICAgICAgIGlmIGNoaWxkLk5hbWUgPT0gIkJhc2tldGJhbGwiIHRoZW4NCiAgICAgICAgICAgIGxvY2FsIHBhcnQgPSBjaGlsZDpJc0EoIkJhc2VQYXJ0IikgYW5kIGNoaWxkIG9yIGNoaWxkOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkJhc2VQYXJ0IikNCiAgICAgICAgICAgIGlmIHBhcnQgdGhlbg0KICAgICAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAocGFydC5Qb3NpdGlvbiAtIGhycC5Qb3NpdGlvbikuTWFnbml0dWRlDQogICAgICAgICAgICAgICAgaWYgZGlzdCA8IGNsb3Nlc3REaXN0IGFuZCBkaXN0IDw9IG1heERpc3RhbmNlIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgY2xvc2VzdERpc3QgPSBkaXN0DQogICAgICAgICAgICAgICAgICAgIGNsb3Nlc3RCYWxsID0gcGFydA0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVuZA0KDQogICAgaWYgY2xvc2VzdEJhbGwgdGhlbg0KICAgICAgICBsb2NhbCB0YXJnZXRQb3NpdGlvbiA9IGNsb3Nlc3RCYWxsLlBvc2l0aW9uICsgY2xvc2VzdEJhbGwuQ0ZyYW1lLkxvb2tWZWN0b3IgKiBvZmZzZXREaXN0YW5jZQ0KICAgICAgICBocnAuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyh0YXJnZXRQb3NpdGlvbikNCiAgICBlbmQNCmVuZCkNCg0KbG9jYWwgZnVuY3Rpb24gdG9nZ2xlVGVsZXBvcnQoKQ0KICAgIHRlbGVwb3J0RW5hYmxlZCA9IG5vdCB0ZWxlcG9ydEVuYWJsZWQNCmVuZA0KDQpSZWJvdW5kR3JvdXA6QWRkVG9nZ2xlKCJSZWJvdW5kQXV0b1N0ZWFsIiwgew0KICAgIFRleHQgPSAiQXV0byBSZWJvdW5kICYgU3RlYWwiLA0KICAgIERlZmF1bHQgPSBmYWxzZSwNCiAgICBUb29sdGlwID0gIldpbGwgYXV0b21hdGljYWxseSByZWJvdW5kIGFuZCBzdGVhbCB0aGUgYmFsbCIsDQogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihlbmFibGVkKQ0KICAgICAgICB0b2dnbGVUZWxlcG9ydChlbmFibGVkKSANCiAgICBlbmQNCn0pDQo6QWRkS2V5UGlja2VyKCJSZWJvdW5kQXV0b1N0ZWFsS2V5Iiwgew0KICAgIERlZmF1bHQgPSAiVCIsDQogICAgU3luY1RvZ2dsZVN0YXRlID0gdHJ1ZSwNCiAgICBNb2RlID0gIlRvZ2dsZSIsDQogICAgVGV4dCA9ICJBdXRvIFJlYm91bmQgJiBTdGVhbCBLZXkiLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24oYWN0aXZlKQ0KICAgICAgICBSZWJvdW5kR3JvdXA6U2V0VG9nZ2xlKCJSZWJvdW5kQXV0b1N0ZWFsIiwgYWN0aXZlKQ0KICAgIGVuZA0KfSkNCg0KUmVib3VuZEdyb3VwOkFkZFNsaWRlcigiT2Zmc2V0IGRpc3RhbmNlIiwgew0KICAgIFRleHQgPSAiUmVib3VuZCAmIFN0ZWFsIG9mZnNldCBkaXN0YW5jZSIsDQogICAgRGVmYXVsdCA9IDAsDQogICAgTWluID0gMCwNCiAgICBNYXggPSA2LA0KICAgIFJvdW5kaW5nID0gMSwNCiAgICBUb29sdGlwID0gImhvdyBmYXIgYWhlYWQgb2YgdGhlIGJhc2tldGJhbGwgeW91IHdpbGwgYmUgdGVsZXBvcnRlZCB0byIsDQogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkNCiAgICAgICAgb2Zmc2V0RGlzdGFuY2UgPSB2YWx1ZQ0KICAgIGVuZA0KfSkNCg0KbG9jYWwgRm9sbG93QmFsbENhcnJpZXJHcm91cCA9IFRhYnMuTWFpbjpBZGRMZWZ0R3JvdXBib3goIkZvbGxvdyBCYWxsIENhcnJpZXIiLCAidXNlcnMiKQ0KDQpsb2NhbCBmb2xsb3dFbmFibGVkID0gZmFsc2UNCmxvY2FsIGZvbGxvd0Nvbm5lY3Rpb24gPSBuaWwNCmxvY2FsIGZvbGxvd09mZnNldCA9IDMNCg0KbG9jYWwgZnVuY3Rpb24gZW5hYmxlRm9sbG93QmFsbENhcnJpZXIoKQ0KICAgIGlmIGZvbGxvd0VuYWJsZWQgdGhlbiByZXR1cm4gZW5kDQogICAgZm9sbG93RW5hYmxlZCA9IHRydWUNCiAgICANCiAgICBmb2xsb3dDb25uZWN0aW9uID0gUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpDQogICAgICAgIGlmIG5vdCBmb2xsb3dFbmFibGVkIHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICANCiAgICAgICAgbG9jYWwgY2hhciA9IHBsYXllci5DaGFyYWN0ZXINCiAgICAgICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kDQogICAgICAgIGxvY2FsIGhycCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQ0KICAgICAgICBpZiBub3QgaHJwIHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICANCiAgICAgICAgbG9jYWwgYmFsbENhcnJpZXIsIGJhbGxDYXJyaWVyUm9vdCA9IGZpbmRQbGF5ZXJXaXRoQmFsbCgpDQogICAgICAgIA0KICAgICAgICBpZiBiYWxsQ2FycmllciBhbmQgYmFsbENhcnJpZXJSb290IHRoZW4NCiAgICAgICAgICAgIGxvY2FsIG1heERpc3RhbmNlID0gaXNQYXJrIGFuZCAxMDAgb3IgbWF0aC5odWdlDQogICAgICAgICAgICBsb2NhbCBkaXN0ID0gKGhycC5Qb3NpdGlvbiAtIGJhbGxDYXJyaWVyUm9vdC5Qb3NpdGlvbikuTWFnbml0dWRlDQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIGRpc3QgPD0gbWF4RGlzdGFuY2UgdGhlbg0KICAgICAgICAgICAgICAgIGhycC5DRnJhbWUgPSBiYWxsQ2FycmllclJvb3QuQ0ZyYW1lICogQ0ZyYW1lLm5ldygwLCAwLCBmb2xsb3dPZmZzZXQpDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KZW5kDQoNCmxvY2FsIGZ1bmN0aW9uIGRpc2FibGVGb2xsb3dCYWxsQ2FycmllcigpDQogICAgaWYgbm90IGZvbGxvd0VuYWJsZWQgdGhlbiByZXR1cm4gZW5kDQogICAgZm9sbG93RW5hYmxlZCA9IGZhbHNlDQogICAgDQogICAgaWYgZm9sbG93Q29ubmVjdGlvbiB0aGVuDQogICAgICAgIGZvbGxvd0Nvbm5lY3Rpb246RGlzY29ubmVjdCgpDQogICAgICAgIGZvbGxvd0Nvbm5lY3Rpb24gPSBuaWwNCiAgICBlbmQNCmVuZA0KDQpGb2xsb3dCYWxsQ2Fycmllckdyb3VwOkFkZFRvZ2dsZSgiRm9sbG93QmFsbENhcnJpZXIiLCB7DQogICAgVGV4dCA9ICJGb2xsb3cgQmFsbCBDYXJyaWVyIiwNCiAgICBEZWZhdWx0ID0gZmFsc2UsDQogICAgVG9vbHRpcCA9ICJJbnN0YW50bHkgdGVsZXBvcnRzIHlvdSB0byB3aG9ldmVyIGhhcyB0aGUgYmFsbCIsDQogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkNCiAgICAgICAgaWYgdmFsdWUgdGhlbg0KICAgICAgICAgICAgZW5hYmxlRm9sbG93QmFsbENhcnJpZXIoKQ0KICAgICAgICBlbHNlDQogICAgICAgICAgICBkaXNhYmxlRm9sbG93QmFsbENhcnJpZXIoKQ0KICAgICAgICBlbmQNCiAgICBlbmQNCn0pOkFkZEtleVBpY2tlcigiRm9sbG93QmFsbENhcnJpZXJLZXkiLCB7DQogICAgRGVmYXVsdCA9ICJIIiwNCiAgICBTeW5jVG9nZ2xlU3RhdGUgPSB0cnVlLA0KICAgIE1vZGUgPSAiVG9nZ2xlIiwNCiAgICBUZXh0ID0gIkZvbGxvdyBCYWxsIENhcnJpZXIgS2V5IiwNCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKGFjdGl2ZSkNCiAgICAgICAgRm9sbG93QmFsbENhcnJpZXJHcm91cDpTZXRUb2dnbGUoIkZvbGxvd0JhbGxDYXJyaWVyIiwgYWN0aXZlKQ0KICAgIGVuZA0KfSkNCg0KRm9sbG93QmFsbENhcnJpZXJHcm91cDpBZGRTbGlkZXIoIkZvbGxvd09mZnNldCIsIHsNCiAgICBUZXh0ID0gIkZvbGxvdyBPZmZzZXQiLA0KICAgIERlZmF1bHQgPSAtMTAsDQogICAgTWluID0gLTEwLA0KICAgIE1heCA9IDEwLA0KICAgIFJvdW5kaW5nID0gMCwNCiAgICBUb29sdGlwID0gIkRpc3RhbmNlIGluIGZyb250IG9mIHRoZSBiYWxsIGNhcnJpZXIiLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIGZvbGxvd09mZnNldCA9IHZhbHVlDQogICAgZW5kDQp9KQ0KDQpsb2NhbCBzdGVhbFJlYWNoRW5hYmxlZCA9IGZhbHNlDQpsb2NhbCBzdGVhbFJlYWNoTXVsdGlwbGllciA9IDMNCmxvY2FsIG9yaWdpbmFsUmlnaHRBcm1TaXplID0gbmlsDQpsb2NhbCBvcmlnaW5hbExlZnRBcm1TaXplID0gbmlsDQpsb2NhbCBhcm1Db25uZWN0aW9uID0gbmlsDQoNCmxvY2FsIE1hZ3NEaXN0ID0gMzANCmxvY2FsIG1hZ25ldEVuYWJsZWQgPSBmYWxzZQ0KbG9jYWwgbWFnbmV0Q29ubmVjdGlvbiA9IG5pbA0KDQpsb2NhbCBzdGVhbFJlYWNoRW5hYmxlZCA9IGZhbHNlDQpsb2NhbCBzdGVhbFJlYWNoTXVsdGlwbGllciA9IDMNCmxvY2FsIG9yaWdpbmFsUmlnaHRBcm1TaXplID0gbmlsDQpsb2NhbCBvcmlnaW5hbExlZnRBcm1TaXplID0gbmlsDQpsb2NhbCBhcm1Db25uZWN0aW9uID0gbmlsDQoNCmxvY2FsIHN0ZWFsUmVhY2hFbmFibGVkID0gZmFsc2UNCmxvY2FsIHN0ZWFsUmVhY2hNdWx0aXBsaWVyID0gMw0KbG9jYWwgb3JpZ2luYWxSaWdodEFybVNpemUgPSBuaWwNCmxvY2FsIG9yaWdpbmFsTGVmdEFybVNpemUgPSBuaWwNCmxvY2FsIGFybUNvbm5lY3Rpb24gPSBuaWwNCmxvY2FsIFN0ZWFsR3JvdXAgPSBUYWJzLk1haW46QWRkUmlnaHRHcm91cGJveCgiU3RlYWwgUmVhY2giLCAiaGFuZCIpDQoNCmxvY2FsIGZ1bmN0aW9uIHVwZGF0ZUhpdGJveFNpemVzKCkNCiAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3Rlcg0KICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZA0KICAgIA0KICAgIGxvY2FsIHJpZ2h0QXJtID0gY2hhcjpGaW5kRmlyc3RDaGlsZCgiUmlnaHQgQXJtIikgb3IgY2hhcjpGaW5kRmlyc3RDaGlsZCgiUmlnaHRIYW5kIikgb3IgY2hhcjpGaW5kRmlyc3RDaGlsZCgiUmlnaHRMb3dlckFybSIpDQogICAgbG9jYWwgbGVmdEFybSA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkxlZnQgQXJtIikgb3IgY2hhcjpGaW5kRmlyc3RDaGlsZCgiTGVmdEhhbmQiKSBvciBjaGFyOkZpbmRGaXJzdENoaWxkKCJMZWZ0TG93ZXJBcm0iKQ0KICAgIA0KICAgIGlmIHN0ZWFsUmVhY2hFbmFibGVkIHRoZW4NCiAgICAgICAgLS0gUmlnaHQgQXJtIC0gY3ViZSBoaXRib3gNCiAgICAgICAgaWYgcmlnaHRBcm0gdGhlbg0KICAgICAgICAgICAgaWYgbm90IG9yaWdpbmFsUmlnaHRBcm1TaXplIHRoZW4NCiAgICAgICAgICAgICAgICBvcmlnaW5hbFJpZ2h0QXJtU2l6ZSA9IHJpZ2h0QXJtLlNpemUNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgcmlnaHRBcm0uU2l6ZSA9IFZlY3RvcjMubmV3KA0KICAgICAgICAgICAgICAgIG9yaWdpbmFsUmlnaHRBcm1TaXplLlggKiBzdGVhbFJlYWNoTXVsdGlwbGllciwNCiAgICAgICAgICAgICAgICBvcmlnaW5hbFJpZ2h0QXJtU2l6ZS5ZICogc3RlYWxSZWFjaE11bHRpcGxpZXIsDQogICAgICAgICAgICAgICAgb3JpZ2luYWxSaWdodEFybVNpemUuWiAqIHN0ZWFsUmVhY2hNdWx0aXBsaWVyDQogICAgICAgICAgICApDQogICAgICAgICAgICByaWdodEFybS5UcmFuc3BhcmVuY3kgPSAxDQogICAgICAgICAgICByaWdodEFybS5DYW5Db2xsaWRlID0gZmFsc2UgDQogICAgICAgICAgICByaWdodEFybS5NYXNzbGVzcyA9IHRydWUgDQogICAgICAgIGVuZA0KICAgICAgICANCiAgICAgICAgLS0gTGVmdCBBcm0gLSBjdWJlIGhpdGJveA0KICAgICAgICBpZiBsZWZ0QXJtIHRoZW4NCiAgICAgICAgICAgIGlmIG5vdCBvcmlnaW5hbExlZnRBcm1TaXplIHRoZW4NCiAgICAgICAgICAgICAgICBvcmlnaW5hbExlZnRBcm1TaXplID0gbGVmdEFybS5TaXplDQogICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGxlZnRBcm0uU2l6ZSA9IFZlY3RvcjMubmV3KA0KICAgICAgICAgICAgICAgIG9yaWdpbmFsTGVmdEFybVNpemUuWCAqIHN0ZWFsUmVhY2hNdWx0aXBsaWVyLA0KICAgICAgICAgICAgICAgIG9yaWdpbmFsTGVmdEFybVNpemUuWSAqIHN0ZWFsUmVhY2hNdWx0aXBsaWVyLA0KICAgICAgICAgICAgICAgIG9yaWdpbmFsTGVmdEFybVNpemUuWiAqIHN0ZWFsUmVhY2hNdWx0aXBsaWVyDQogICAgICAgICAgICApDQogICAgICAgICAgICBsZWZ0QXJtLlRyYW5zcGFyZW5jeSA9IDENCiAgICAgICAgICAgIGxlZnRBcm0uQ2FuQ29sbGlkZSA9IGZhbHNlIA0KICAgICAgICAgICAgbGVmdEFybS5NYXNzbGVzcyA9IHRydWUgDQogICAgICAgIGVuZA0KICAgIGVsc2UNCiAgICAgICAgLS0gUmVzZXQgUmlnaHQgQXJtDQogICAgICAgIGlmIHJpZ2h0QXJtIGFuZCBvcmlnaW5hbFJpZ2h0QXJtU2l6ZSB0aGVuDQogICAgICAgICAgICByaWdodEFybS5TaXplID0gb3JpZ2luYWxSaWdodEFybVNpemUNCiAgICAgICAgICAgIHJpZ2h0QXJtLlRyYW5zcGFyZW5jeSA9IDANCiAgICAgICAgICAgIHJpZ2h0QXJtLkNhbkNvbGxpZGUgPSBmYWxzZQ0KICAgICAgICAgICAgcmlnaHRBcm0uTWFzc2xlc3MgPSBmYWxzZQ0KICAgICAgICAgICAgb3JpZ2luYWxSaWdodEFybVNpemUgPSBuaWwNCiAgICAgICAgZW5kDQogICAgICAgIA0KICAgICAgICAtLSBSZXNldCBMZWZ0IEFybQ0KICAgICAgICBpZiBsZWZ0QXJtIGFuZCBvcmlnaW5hbExlZnRBcm1TaXplIHRoZW4NCiAgICAgICAgICAgIGxlZnRBcm0uU2l6ZSA9IG9yaWdpbmFsTGVmdEFybVNpemUNCiAgICAgICAgICAgIGxlZnRBcm0uVHJhbnNwYXJlbmN5ID0gMA0KICAgICAgICAgICAgbGVmdEFybS5DYW5Db2xsaWRlID0gZmFsc2UNCiAgICAgICAgICAgIGxlZnRBcm0uTWFzc2xlc3MgPSBmYWxzZQ0KICAgICAgICAgICAgb3JpZ2luYWxMZWZ0QXJtU2l6ZSA9IG5pbA0KICAgICAgICBlbmQNCiAgICBlbmQNCmVuZA0KDQpTdGVhbEdyb3VwOkFkZFRvZ2dsZSgiU3RlYWxSZWFjaCIsIHsNCiAgICBUZXh0ID0gIlN0ZWFsIFJlYWNoIiwNCiAgICBEZWZhdWx0ID0gZmFsc2UsDQogICAgVG9vbHRpcCA9ICJFeHBhbmRzIGJvdGggYXJtcyBmb3IgZWFzaWVyIHN0ZWFscy4iLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIHN0ZWFsUmVhY2hFbmFibGVkID0gdmFsdWUNCiAgICAgICAgdXBkYXRlSGl0Ym94U2l6ZXMoKQ0KICAgICAgICANCiAgICAgICAgaWYgdmFsdWUgdGhlbg0KICAgICAgICAgICAgaWYgbm90IGFybUNvbm5lY3Rpb24gdGhlbg0KICAgICAgICAgICAgICAgIGFybUNvbm5lY3Rpb24gPSBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpDQogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQ0KICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbFJpZ2h0QXJtU2l6ZSA9IG5pbA0KICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbExlZnRBcm1TaXplID0gbmlsDQogICAgICAgICAgICAgICAgICAgIHVwZGF0ZUhpdGJveFNpemVzKCkNCiAgICAgICAgICAgICAgICBlbmQpDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgaWYgYXJtQ29ubmVjdGlvbiB0aGVuDQogICAgICAgICAgICAgICAgYXJtQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkNCiAgICAgICAgICAgICAgICBhcm1Db25uZWN0aW9uID0gbmlsDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQp9KQ0KDQpTdGVhbEdyb3VwOkFkZFNsaWRlcigiU3RlYWxNdWx0aXBsaWVyIiwgew0KICAgIFRleHQgPSAiUmVhY2ggTXVsdGlwbGllciIsDQogICAgRGVmYXVsdCA9IDMsDQogICAgTWluID0gMSwNCiAgICBNYXggPSAyNSwNCiAgICBSb3VuZGluZyA9IDEsDQogICAgQ29tcGFjdCA9IGZhbHNlLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIHN0ZWFsUmVhY2hNdWx0aXBsaWVyID0gdmFsdWUNCiAgICAgICAgaWYgc3RlYWxSZWFjaEVuYWJsZWQgdGhlbg0KICAgICAgICAgICAgdXBkYXRlSGl0Ym94U2l6ZXMoKQ0KICAgICAgICBlbmQNCiAgICBlbmQNCn0pDQoNCmxvY2FsIEJhbGxNYWduZXRHcm91cCA9IFRhYnMuTWFpbjpBZGRSaWdodEdyb3VwYm94KCJCYWxsIE1hZ25ldCIpDQoNCkJhbGxNYWduZXRHcm91cDpBZGRUb2dnbGUoIkJhbGxNYWduZXQiLCB7DQogICAgVGV4dCA9ICJCYWxsIE1hZ25ldCIsDQogICAgRGVmYXVsdCA9IGZhbHNlLA0KICAgIFRvb2x0aXAgPSAiQXV0b21hdGljYWxseSBtYWduZXRzIHlvdSB0byB0aGUgYmFza2V0YmFsbCIsDQogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkNCiAgICAgICAgbWFnbmV0RW5hYmxlZCA9IHZhbHVlDQogICAgICAgIGlmIG5vdCB2YWx1ZSBhbmQgbWFnbmV0Q29ubmVjdGlvbiB0aGVuDQogICAgICAgICAgICBtYWduZXRDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQ0KICAgICAgICAgICAgbWFnbmV0Q29ubmVjdGlvbiA9IG5pbA0KICAgICAgICBlbmQNCiAgICBlbmQNCn0pOkFkZEtleVBpY2tlcigiQmFsbE1hZ25ldEtleSIsIHsNCiAgICBEZWZhdWx0ID0gIk0iLA0KICAgIFN5bmNUb2dnbGVTdGF0ZSA9IHRydWUsDQogICAgTW9kZSA9ICJUb2dnbGUiLA0KICAgIFRleHQgPSAiQmFsbCBNYWduZXQgS2V5IiwNCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKGFjdGl2ZSkNCiAgICAgICAgQmFsbE1hZ25ldEdyb3VwOlNldFRvZ2dsZSgiQmFsbE1hZ25ldCIsIGFjdGl2ZSkNCiAgICBlbmQNCn0pDQoNCkJhbGxNYWduZXRHcm91cDpBZGRTbGlkZXIoIkJhbGxNYWduZXREaXN0YW5jZSIsIHsNCiAgICBUZXh0ID0gIk1hZ25ldCBEaXN0YW5jZSIsDQogICAgRGVmYXVsdCA9IDMwLA0KICAgIE1pbiA9IDEwLA0KICAgIE1heCA9IDg1LA0KICAgIFJvdW5kaW5nID0gMCwNCiAgICBUb29sdGlwID0gIk1heGltdW0gZGlzdGFuY2UgdG8gbWFnbmV0IGZyb20iLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIE1hZ3NEaXN0ID0gdmFsdWUNCiAgICBlbmQNCn0pDQoNCm1hZ25ldENvbm5lY3Rpb24gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkNCiAgICBpZiBub3QgbWFnbmV0RW5hYmxlZCB0aGVuIHJldHVybiBlbmQNCiAgICANCiAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3Rlcg0KICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZA0KICAgIGxvY2FsIGhycCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQ0KICAgIGlmIG5vdCBocnAgdGhlbiByZXR1cm4gZW5kDQogICAgDQogICAgLS0gQ2hlY2sgZm9yIGxvb3NlIGJhbGwgKEJhc2VQYXJ0IGluIHdvcmtzcGFjZSkNCiAgICBsb2NhbCBsb29zZUJhbGwgPSB3b3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoIkJhc2tldGJhbGwiKQ0KICAgIGlmIGxvb3NlQmFsbCBhbmQgbG9vc2VCYWxsOklzQSgiQmFzZVBhcnQiKSB0aGVuDQogICAgICAgIGxvY2FsIGRpc3QgPSAoaHJwLlBvc2l0aW9uIC0gbG9vc2VCYWxsLlBvc2l0aW9uKS5NYWduaXR1ZGUNCiAgICAgICAgaWYgZGlzdCA8PSBNYWdzRGlzdCB0aGVuDQogICAgICAgICAgICBsb2NhbCB0b3VjaCA9IGxvb3NlQmFsbDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIlRvdWNoVHJhbnNtaXR0ZXIiKQ0KICAgICAgICAgICAgaWYgbm90IHRvdWNoIHRoZW4NCiAgICAgICAgICAgICAgICBmb3IgXywgZCBpbiBpcGFpcnMobG9vc2VCYWxsOkdldERlc2NlbmRhbnRzKCkpIGRvDQogICAgICAgICAgICAgICAgICAgIGlmIGQ6SXNBKCJUb3VjaFRyYW5zbWl0dGVyIikgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgdG91Y2ggPSBkDQogICAgICAgICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgaWYgdG91Y2ggdGhlbg0KICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KGhycCwgbG9vc2VCYWxsLCAwKQ0KICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KGhycCwgbG9vc2VCYWxsLCAxKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVsc2UNCiAgICAgICAgLS0gQ2hlY2sgZm9yIGJhbGwgZXF1aXBwZWQgYnkgb3RoZXIgcGxheWVycyAoVG9vbCkNCiAgICAgICAgZm9yIF8sIG1vZGVsIGluIHBhaXJzKHdvcmtzcGFjZTpHZXRDaGlsZHJlbigpKSBkbw0KICAgICAgICAgICAgaWYgbW9kZWw6SXNBKCJNb2RlbCIpIGFuZCBtb2RlbCB+PSBjaGFyIGFuZCBtb2RlbDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4NCiAgICAgICAgICAgICAgICBsb2NhbCB0b29sID0gbW9kZWw6RmluZEZpcnN0Q2hpbGQoIkJhc2tldGJhbGwiKQ0KICAgICAgICAgICAgICAgIGlmIHRvb2wgYW5kIHRvb2w6SXNBKCJUb29sIikgdGhlbg0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBoYW5kbGUgPSB0b29sOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUiKSBvciB0b29sOkZpbmRGaXJzdENoaWxkV2hpY2hJc0EoIkJhc2VQYXJ0IikNCiAgICAgICAgICAgICAgICAgICAgaWYgaGFuZGxlIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3QgPSAoaHJwLlBvc2l0aW9uIC0gaGFuZGxlLlBvc2l0aW9uKS5NYWduaXR1ZGUNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRpc3QgPD0gTWFnc0Rpc3QgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRvdWNoID0gaGFuZGxlOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiVG91Y2hUcmFuc21pdHRlciIpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHRvdWNoIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIGQgaW4gaXBhaXJzKGhhbmRsZTpHZXREZXNjZW5kYW50cygpKSBkbw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZDpJc0EoIlRvdWNoVHJhbnNtaXR0ZXIiKSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG91Y2ggPSBkDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b3VjaCB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KGhycCwgaGFuZGxlLCAwKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChocnAsIGhhbmRsZSwgMSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCmVuZCkNCg0KVXNlcklucHV0U2VydmljZS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQsIGdhbWVQcm9jZXNzZWQpDQogICAgaWYgaW5wdXQuS2V5Q29kZSA9PSBFbnVtLktleUNvZGUuRyBhbmQgbm90IGdhbWVQcm9jZXNzZWQgdGhlbg0KICAgICAgICBpZiBhdXRvR3VhcmRUb2dnbGVFbmFibGVkIHRoZW4NCiAgICAgICAgICAgIGhvbGRpbmdHID0gdHJ1ZQ0KICAgICAgICAgICAgYXV0b0d1YXJkRW5hYmxlZCA9IHRydWUNCiAgICAgICAgICAgIGxhc3RQb3NpdGlvbnMgPSB7fQ0KICAgICAgICAgICAgaWYgbm90IGF1dG9HdWFyZENvbm5lY3Rpb24gdGhlbg0KICAgICAgICAgICAgICAgIGF1dG9HdWFyZENvbm5lY3Rpb24gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGF1dG9HdWFyZCkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCmVuZCkNCg0KVXNlcklucHV0U2VydmljZS5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQsIGdhbWVQcm9jZXNzZWQpDQogICAgaWYgaW5wdXQuS2V5Q29kZSA9PSBFbnVtLktleUNvZGUuRyB0aGVuDQogICAgICAgIGhvbGRpbmdHID0gZmFsc2UNCiAgICAgICAgYXV0b0d1YXJkRW5hYmxlZCA9IGZhbHNlDQogICAgICAgIA0KICAgICAgICBpZiBhdXRvR3VhcmRDb25uZWN0aW9uIHRoZW4NCiAgICAgICAgICAgIGF1dG9HdWFyZENvbm5lY3Rpb246RGlzY29ubmVjdCgpDQogICAgICAgICAgICBhdXRvR3VhcmRDb25uZWN0aW9uID0gbmlsDQogICAgICAgIGVuZA0KICAgICAgICANCiAgICAgICAgbGFzdFBvc2l0aW9ucyA9IHt9DQogICAgICAgIA0KICAgICAgICBsb2NhbCBWaXJ0dWFsSW5wdXRNYW5hZ2VyID0gZ2FtZTpHZXRTZXJ2aWNlKCJWaXJ0dWFsSW5wdXRNYW5hZ2VyIikNCiAgICAgICAgVmlydHVhbElucHV0TWFuYWdlcjpTZW5kS2V5RXZlbnQoZmFsc2UsIEVudW0uS2V5Q29kZS5GLCBmYWxzZSwgZ2FtZSkNCiAgICBlbmQNCmVuZCkNCg0KR3VhcmRHcm91cDpBZGRMYWJlbCgiSG9sZCBHIHRvIGFjdGl2YXRlIGF1dG8gZ3VhcmRcbih0b2dnbGUgbXVzdCBiZSBlbmFibGVkKSIsIHRydWUpDQoNCkd1YXJkR3JvdXA6QWRkU2xpZGVyKCJHdWFyZERpc3RhbmNlIiwgew0KICAgIFRleHQgPSAiR3VhcmQgRGlzdGFuY2UiLA0KICAgIERlZmF1bHQgPSAxMCwNCiAgICBNaW4gPSA1LA0KICAgIE1heCA9IDIwLA0KICAgIFJvdW5kaW5nID0gMCwNCiAgICBUb29sdGlwID0gIk1heGltdW0gZGlzdGFuY2UgdG8gc3RhcnQgZ3VhcmRpbmciLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIGd1YXJkRGlzdGFuY2UgPSB2YWx1ZQ0KICAgIGVuZA0KfSkNCg0KR3VhcmRHcm91cDpBZGRTbGlkZXIoIlByZWRpY3Rpb25UaW1lIiwgew0KICAgIFRleHQgPSAiUHJlZGljdGlvbiBUaW1lIiwNCiAgICBEZWZhdWx0ID0gMC4zLA0KICAgIE1pbiA9IDAuMSwNCiAgICBNYXggPSAwLjgsDQogICAgUm91bmRpbmcgPSAxLA0KICAgIFRvb2x0aXAgPSAiSG93IGZhciBhaGVhZCB0byBwcmVkaWN0IG9wcG9uZW50IG1vdmVtZW50IChzZWNvbmRzKSIsDQogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkNCiAgICAgICAgcHJlZGljdGlvblRpbWUgPSB2YWx1ZQ0KICAgIGVuZA0KfSkNCg0KR3VhcmRHcm91cDpBZGRMYWJlbCgiQXV0byBHdWFyZCB3aWxsIHByZWRpY3Qgb3Bwb25lbnRcbm1vdmVtZW50IGFuZCBwb3NpdGlvbiBkZWZlbnNpdmVseVxuaW4gZnJvbnQgb2YgdGhlbSB3aGlsZSBob2xkaW5nIEYuIiwgdHJ1ZSkNCg0KbG9jYWwgZnVuY3Rpb24gc3RhcnRDRnJhbWVTcGVlZChzcGVlZCkNCiAgICBsb2NhbCBjb25uZWN0aW9uDQogICAgY29ubmVjdGlvbiA9IFJ1blNlcnZpY2UuUmVuZGVyU3RlcHBlZDpDb25uZWN0KGZ1bmN0aW9uKGRlbHRhVGltZSkNCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3Rlcg0KICAgICAgICBpZiBub3QgY2hhcmFjdGVyIHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICBsb2NhbCByb290ID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikNCiAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpDQogICAgICAgIGlmIG5vdCByb290IG9yIG5vdCBodW1hbm9pZCB0aGVuIHJldHVybiBlbmQNCg0KICAgICAgICBsb2NhbCBtb3ZlVmVjID0gaHVtYW5vaWQuTW92ZURpcmVjdGlvbg0KICAgICAgICBpZiBtb3ZlVmVjLk1hZ25pdHVkZSA+IDAgdGhlbg0KICAgICAgICAgICAgbG9jYWwgc3BlZWREZWx0YSA9IG1hdGgubWF4KHNwZWVkIC0gaHVtYW5vaWQuV2Fsa1NwZWVkLCAwKQ0KICAgICAgICAgICAgcm9vdC5DRnJhbWUgPSByb290LkNGcmFtZSArIChtb3ZlVmVjLlVuaXQgKiBzcGVlZERlbHRhICogZGVsdGFUaW1lKQ0KICAgICAgICBlbmQNCiAgICBlbmQpDQogICAgcmV0dXJuIGZ1bmN0aW9uKCkNCiAgICAgICAgaWYgY29ubmVjdGlvbiB0aGVuDQogICAgICAgICAgICBjb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQ0KICAgICAgICBlbmQNCiAgICBlbmQNCmVuZA0KDQpTcGVlZEdyb3VwOkFkZFRvZ2dsZSgiU3BlZWRCb29zdCIsIHsNCiAgICBUZXh0ID0gIlNwZWVkIEJvb3N0IiwNCiAgICBEZWZhdWx0ID0gZmFsc2UsDQogICAgVG9vbHRpcCA9ICJFbmFibGUgb3IgZGlzYWJsZSBzcGVlZCBib29zdCAoQ0ZyYW1lIG1ldGhvZCkiLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIHNwZWVkQm9vc3RFbmFibGVkID0gdmFsdWUNCiAgICAgICAgaWYgdmFsdWUgdGhlbg0KICAgICAgICAgICAgaWYgc3BlZWRCb29zdENvbm5lY3Rpb24gdGhlbiBzcGVlZEJvb3N0Q29ubmVjdGlvbigpIGVuZA0KICAgICAgICAgICAgc3BlZWRCb29zdENvbm5lY3Rpb24gPSBzdGFydENGcmFtZVNwZWVkKGRlc2lyZWRTcGVlZCkNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgaWYgc3BlZWRCb29zdENvbm5lY3Rpb24gdGhlbiBzcGVlZEJvb3N0Q29ubmVjdGlvbigpIGVuZA0KICAgICAgICAgICAgc3BlZWRCb29zdENvbm5lY3Rpb24gPSBuaWwNCiAgICAgICAgZW5kDQogICAgZW5kDQp9KQ0KDQpTcGVlZEdyb3VwOkFkZFNsaWRlcigiU3BlZWRBbW91bnQiLCB7DQogICAgVGV4dCA9ICJTcGVlZCBBbW91bnQiLA0KICAgIERlZmF1bHQgPSAxNiwNCiAgICBNaW4gPSAxNiwNCiAgICBNYXggPSAyMywNCiAgICBSb3VuZGluZyA9IDEsDQogICAgVG9vbHRpcCA9ICJBZGp1c3QgdGhlIHNwZWVkIGJvb3N0IGFtb3VudCIsDQogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkNCiAgICAgICAgZGVzaXJlZFNwZWVkID0gdmFsdWUNCiAgICAgICAgaWYgc3BlZWRCb29zdEVuYWJsZWQgdGhlbg0KICAgICAgICAgICAgaWYgc3BlZWRCb29zdENvbm5lY3Rpb24gdGhlbiBzcGVlZEJvb3N0Q29ubmVjdGlvbigpIGVuZA0KICAgICAgICAgICAgc3BlZWRCb29zdENvbm5lY3Rpb24gPSBzdGFydENGcmFtZVNwZWVkKGRlc2lyZWRTcGVlZCkNCiAgICAgICAgZW5kDQogICAgZW5kDQp9KQ0KDQpsb2NhbCBmdW5jdGlvbiBzZXRCR1Zpc2libGVUb1RydWUoKQ0KICAgIGZvciBfLCBtb2RlbCBpbiBwYWlycyh3b3Jrc3BhY2U6R2V0Q2hpbGRyZW4oKSkgZG8NCiAgICAgICAgaWYgbW9kZWw6SXNBKCJNb2RlbCIpIGFuZCBtb2RlbDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4NCiAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBtb2RlbC5IdW1hbm9pZFJvb3RQYXJ0DQogICAgICAgICAgICBmb3IgXywgb2JqIGluIHBhaXJzKGh1bWFub2lkUm9vdFBhcnQ6R2V0RGVzY2VuZGFudHMoKSkgZG8NCiAgICAgICAgICAgICAgICBpZiBvYmouTmFtZSA9PSAiQkciIGFuZCBvYmo6SXNBKCJCb2R5R3lybyIpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgb2JqLlBhcmVudCA9IGh1bWFub2lkUm9vdFBhcnQNCiAgICAgICAgICAgICAgICAgICAgb2JqLk1heFRvcnF1ZSA9IFZlY3RvcjMubmV3KDllOSwgOWU5LCA5ZTkpDQogICAgICAgICAgICAgICAgICAgIG9iai5QID0gOWU0DQogICAgICAgICAgICAgICAgICAgIG9iai5EID0gNTAwDQogICAgICAgICAgICAgICAgICAgIG9iai5DRnJhbWUgPSBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVuZA0KZW5kDQoNCmxvY2FsIGZ1bmN0aW9uIGhpZGVCRygpDQogICAgZm9yIF8sIG1vZGVsIGluIHBhaXJzKHdvcmtzcGFjZTpHZXRDaGlsZHJlbigpKSBkbw0KICAgICAgICBpZiBtb2RlbDpJc0EoIk1vZGVsIikgYW5kIG1vZGVsOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbg0KICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IG1vZGVsLkh1bWFub2lkUm9vdFBhcnQNCiAgICAgICAgICAgIGZvciBfLCBvYmogaW4gcGFpcnMoaHVtYW5vaWRSb290UGFydDpHZXREZXNjZW5kYW50cygpKSBkbw0KICAgICAgICAgICAgICAgIGlmIG9iai5OYW1lID09ICJCRyIgYW5kIG9iajpJc0EoIkJvZHlHeXJvIikgdGhlbg0KICAgICAgICAgICAgICAgICAgICBvYmouUGFyZW50ID0gbmlsDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQplbmQNCg0KTWlzY0dyb3VwOkFkZFRvZ2dsZSgiU2hvd0JHIiwgew0KICAgIFRleHQgPSAiU2hvdyBCb2R5R3lybyIsDQogICAgRGVmYXVsdCA9IGZhbHNlLA0KICAgIFRvb2x0aXAgPSAiTWFrZXMgQm9keUd5cm8gdmlzaWJsZSBmb3IgYWxsIHBsYXllcnMiLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIGlmIHZhbHVlIHRoZW4NCiAgICAgICAgICAgIHNldEJHVmlzaWJsZVRvVHJ1ZSgpDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGhpZGVCRygpDQogICAgICAgIGVuZA0KICAgIGVuZA0KfSkNCg0KbG9jYWwgQW5pbWF0aW9uc0ZvbGRlciA9IFJlcGxpY2F0ZWRTdG9yYWdlOldhaXRGb3JDaGlsZCgiQXNzZXRzIik6V2FpdEZvckNoaWxkKCJBbmltYXRpb25zX1IxNSIpDQpsb2NhbCBzZWxlY3RlZER1bmtBbmltID0gIkRlZmF1bHQiDQpsb2NhbCBzZWxlY3RlZEVtb3RlQW5pbSA9ICJEYW5jZV9DYXN1YWwiDQpsb2NhbCBhbmltYXRpb25TcG9vZkVuYWJsZWQgPSBmYWxzZQ0KbG9jYWwgZHVua1Nwb29mQ29ubmVjdGlvbiA9IG5pbA0KbG9jYWwgZW1vdGVTcG9vZkNvbm5lY3Rpb24gPSBuaWwNCmxvY2FsIGNoYXJBZGRlZENvbm5EdW5rID0gbmlsDQpsb2NhbCBjaGFyQWRkZWRDb25uRW1vdGUgPSBuaWwNCg0KbG9jYWwgRW1vdGVBbmltYXRpb25zID0gew0KICAgIERlZmF1bHQgPSAiRGFuY2VfQ2FzdWFsIiwNCiAgICBEYW5jZV9TdHVyZHkgPSAiRGFuY2VfU3R1cmR5IiwNCiAgICBEYW5jZV9UYXVudCA9ICJEYW5jZV9UYXVudCIsDQogICAgRGFuY2VfVGFrZUZsaWdodCA9ICJEYW5jZV9UYWtlRmxpZ2h0IiwNCiAgICBEYW5jZV9GbGV4ID0gIkRhbmNlX0ZsZXgiLA0KICAgIERhbmNlX0JhdCA9ICJEYW5jZV9CYXQiLA0KICAgIERhbmNlX1R3aXN0ID0gIkRhbmNlX1R3aXN0IiwNCiAgICBEYW5jZV9HcmlkZHkgPSAiRGFuY2VfR3JpZGR5IiwNCiAgICBEYW5jZV9EYWIgPSAiRGFuY2VfRGFiIiwNCiAgICBEYW5jZV9EcmFrZSA9ICJEYW5jZV9EcmFrZSIsDQogICAgRGFuY2VfRnJlc2ggPSAiRGFuY2VfRnJlc2giLA0KICAgIERhbmNlX0h5cGUgPSAiRGFuY2VfSHlwZSIsDQogICAgRGFuY2VfU3BvbmdlYm9iID0gIkRhbmNlX1Nwb25nZWJvYiIsDQogICAgRGFuY2VfQmFja2ZsaXAgPSAiRGFuY2VfQmFja2ZsaXAiLA0KICAgIERhbmNlX0wgPSAiRGFuY2VfTCIsDQogICAgRGFuY2VfRmFjZXBhbG0gPSAiRGFuY2VfRmFjZXBhbG0iLA0KICAgIERhbmNlX0JvdyA9ICJEYW5jZV9Cb3ciDQp9DQoNCmxvY2FsIGVtb3RlT3B0aW9ucyA9IHt9DQpmb3Iga2V5LCBfIGluIHBhaXJzKEVtb3RlQW5pbWF0aW9ucykgZG8NCiAgICB0YWJsZS5pbnNlcnQoZW1vdGVPcHRpb25zLCBrZXkpDQplbmQNCnRhYmxlLnNvcnQoZW1vdGVPcHRpb25zKQ0KDQpsb2NhbCBmdW5jdGlvbiBzZXR1cER1bmtTcG9vZihodW1hbm9pZCkNCiAgICBsb2NhbCBhbmltYXRvciA9IGh1bWFub2lkOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQW5pbWF0b3IiKSBvciBJbnN0YW5jZS5uZXcoIkFuaW1hdG9yIiwgaHVtYW5vaWQpDQogICAgcmV0dXJuIGFuaW1hdG9yLkFuaW1hdGlvblBsYXllZDpDb25uZWN0KGZ1bmN0aW9uKHRyYWNrKQ0KICAgICAgICBpZiBhbmltYXRpb25TcG9vZkVuYWJsZWQgYW5kIHRyYWNrLkFuaW1hdGlvbi5OYW1lID09ICJEdW5rX0RlZmF1bHQiIGFuZCBzZWxlY3RlZER1bmtBbmltIH49ICJEZWZhdWx0IiB0aGVuDQogICAgICAgICAgICB0cmFjazpTdG9wKCkNCiAgICAgICAgICAgIGxvY2FsIGN1c3RvbUFuaW0gPSBBbmltYXRpb25zRm9sZGVyOkZpbmRGaXJzdENoaWxkKCJEdW5rXyIgLi4gc2VsZWN0ZWREdW5rQW5pbSkNCiAgICAgICAgICAgIGlmIGN1c3RvbUFuaW0gdGhlbg0KICAgICAgICAgICAgICAgIGh1bWFub2lkOkxvYWRBbmltYXRpb24oY3VzdG9tQW5pbSk6UGxheSgpDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kKQ0KZW5kDQoNCmxvY2FsIGZ1bmN0aW9uIHNldHVwRW1vdGVTcG9vZihodW1hbm9pZCkNCiAgICBsb2NhbCBhbmltYXRvciA9IGh1bWFub2lkOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiQW5pbWF0b3IiKSBvciBJbnN0YW5jZS5uZXcoIkFuaW1hdG9yIiwgaHVtYW5vaWQpDQogICAgcmV0dXJuIGFuaW1hdG9yLkFuaW1hdGlvblBsYXllZDpDb25uZWN0KGZ1bmN0aW9uKHRyYWNrKQ0KICAgICAgICBpZiBhbmltYXRpb25TcG9vZkVuYWJsZWQgYW5kIHRyYWNrLkFuaW1hdGlvbi5OYW1lID09ICJEYW5jZV9DYXN1YWwiIGFuZCBzZWxlY3RlZEVtb3RlQW5pbSB+PSAiRGFuY2VfQ2FzdWFsIiB0aGVuDQogICAgICAgICAgICB0cmFjazpTdG9wKCkNCiAgICAgICAgICAgIGxvY2FsIGN1c3RvbUFuaW0gPSBBbmltYXRpb25zRm9sZGVyOkZpbmRGaXJzdENoaWxkKHNlbGVjdGVkRW1vdGVBbmltKQ0KICAgICAgICAgICAgaWYgY3VzdG9tQW5pbSB0aGVuDQogICAgICAgICAgICAgICAgaHVtYW5vaWQ6TG9hZEFuaW1hdGlvbihjdXN0b21BbmltKTpQbGF5KCkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQpDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gZW5hYmxlQW5pbWF0aW9uU3Bvb2YoKQ0KICAgIGxvY2FsIGNoYXIgPSBwbGF5ZXIuQ2hhcmFjdGVyDQogICAgaWYgY2hhciB0aGVuDQogICAgICAgIGxvY2FsIGh1bWFub2lkID0gY2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikNCiAgICAgICAgaWYgaHVtYW5vaWQgdGhlbg0KICAgICAgICAgICAgaWYgZHVua1Nwb29mQ29ubmVjdGlvbiB0aGVuIGR1bmtTcG9vZkNvbm5lY3Rpb246RGlzY29ubmVjdCgpIGVuZA0KICAgICAgICAgICAgaWYgZW1vdGVTcG9vZkNvbm5lY3Rpb24gdGhlbiBlbW90ZVNwb29mQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkgZW5kDQogICAgICAgICAgICBkdW5rU3Bvb2ZDb25uZWN0aW9uID0gc2V0dXBEdW5rU3Bvb2YoaHVtYW5vaWQpDQogICAgICAgICAgICBlbW90ZVNwb29mQ29ubmVjdGlvbiA9IHNldHVwRW1vdGVTcG9vZihodW1hbm9pZCkNCiAgICAgICAgZW5kDQogICAgZW5kDQoNCiAgICBpZiBjaGFyQWRkZWRDb25uRHVuayB0aGVuIGNoYXJBZGRlZENvbm5EdW5rOkRpc2Nvbm5lY3QoKSBlbmQNCiAgICBpZiBjaGFyQWRkZWRDb25uRW1vdGUgdGhlbiBjaGFyQWRkZWRDb25uRW1vdGU6RGlzY29ubmVjdCgpIGVuZA0KDQogICAgY2hhckFkZGVkQ29ubkR1bmsgPSBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChmdW5jdGlvbihuZXdDaGFyKQ0KICAgICAgICBsb2NhbCBodW1hbm9pZCA9IG5ld0NoYXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZCIpDQogICAgICAgIGlmIGR1bmtTcG9vZkNvbm5lY3Rpb24gdGhlbiBkdW5rU3Bvb2ZDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKSBlbmQNCiAgICAgICAgZHVua1Nwb29mQ29ubmVjdGlvbiA9IHNldHVwRHVua1Nwb29mKGh1bWFub2lkKQ0KICAgIGVuZCkNCg0KICAgIGNoYXJBZGRlZENvbm5FbW90ZSA9IHBsYXllci5DaGFyYWN0ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKG5ld0NoYXIpDQogICAgICAgIGxvY2FsIGh1bWFub2lkID0gbmV3Q2hhcjpXYWl0Rm9yQ2hpbGQoIkh1bWFub2lkIikNCiAgICAgICAgaWYgZW1vdGVTcG9vZkNvbm5lY3Rpb24gdGhlbiBlbW90ZVNwb29mQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkgZW5kDQogICAgICAgIGVtb3RlU3Bvb2ZDb25uZWN0aW9uID0gc2V0dXBFbW90ZVNwb29mKGh1bWFub2lkKQ0KICAgIGVuZCkNCmVuZA0KDQpsb2NhbCBmdW5jdGlvbiBkaXNhYmxlQW5pbWF0aW9uU3Bvb2YoKQ0KICAgIGlmIGR1bmtTcG9vZkNvbm5lY3Rpb24gdGhlbg0KICAgICAgICBkdW5rU3Bvb2ZDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQ0KICAgICAgICBkdW5rU3Bvb2ZDb25uZWN0aW9uID0gbmlsDQogICAgZW5kDQogICAgaWYgZW1vdGVTcG9vZkNvbm5lY3Rpb24gdGhlbg0KICAgICAgICBlbW90ZVNwb29mQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkNCiAgICAgICAgZW1vdGVTcG9vZkNvbm5lY3Rpb24gPSBuaWwNCiAgICBlbmQNCiAgICBpZiBjaGFyQWRkZWRDb25uRHVuayB0aGVuDQogICAgICAgIGNoYXJBZGRlZENvbm5EdW5rOkRpc2Nvbm5lY3QoKQ0KICAgICAgICBjaGFyQWRkZWRDb25uRHVuayA9IG5pbA0KICAgIGVuZA0KICAgIGlmIGNoYXJBZGRlZENvbm5FbW90ZSB0aGVuDQogICAgICAgIGNoYXJBZGRlZENvbm5FbW90ZTpEaXNjb25uZWN0KCkNCiAgICAgICAgY2hhckFkZGVkQ29ubkVtb3RlID0gbmlsDQogICAgZW5kDQplbmQNCg0KQW5pbWF0aW9uR3JvdXA6QWRkVG9nZ2xlKCJBbmltYXRpb25TcG9vZiIsIHsNCiAgICBUZXh0ID0gIkFuaW1hdGlvbiBDaGFuZ2VyIiwNCiAgICBEZWZhdWx0ID0gZmFsc2UsDQogICAgVG9vbHRpcCA9ICJFbmFibGUgYW5pbWF0aW9uIHNwb29maW5nIGZvciBkdW5rcyBhbmQgZW1vdGVzIiwNCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQ0KICAgICAgICBhbmltYXRpb25TcG9vZkVuYWJsZWQgPSB2YWx1ZQ0KICAgICAgICBpZiB2YWx1ZSB0aGVuDQogICAgICAgICAgICBlbmFibGVBbmltYXRpb25TcG9vZigpDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGRpc2FibGVBbmltYXRpb25TcG9vZigpDQogICAgICAgIGVuZA0KICAgIGVuZA0KfSkNCg0KQW5pbWF0aW9uR3JvdXA6QWRkRHJvcGRvd24oIkR1bmtTcG9vZiIsIHsNCiAgICBWYWx1ZXMgPSB7IkRlZmF1bHQiLCAiVGVzdGluZyIsICJUZXN0aW5nMiIsICJSZXZlcnNlIiwgIjM2MCIsICJUZXN0aW5nMyIsICJUb21haGF3ayIsICJXaW5kbWlsbCJ9LA0KICAgIERlZmF1bHQgPSAxLA0KICAgIE11bHRpID0gZmFsc2UsDQogICAgVGV4dCA9ICJEdW5rIEFuaW1hdGlvbiIsDQogICAgVG9vbHRpcCA9ICJDaGFuZ2UgeW91ciBkdW5rIGFuaW1hdGlvbiIsDQogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkNCiAgICAgICAgc2VsZWN0ZWREdW5rQW5pbSA9IHZhbHVlDQogICAgZW5kDQp9KQ0KDQpBbmltYXRpb25Hcm91cDpBZGREcm9wZG93bigiRW1vdGVTcG9vZiIsIHsNCiAgICBWYWx1ZXMgPSBlbW90ZU9wdGlvbnMsDQogICAgRGVmYXVsdCA9IDEsDQogICAgTXVsdGkgPSBmYWxzZSwNCiAgICBUZXh0ID0gIkVtb3RlIEFuaW1hdGlvbiIsDQogICAgVG9vbHRpcCA9ICJDaGFuZ2UgeW91ciBlbW90ZS9kYW5jZSBhbmltYXRpb24iLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIHNlbGVjdGVkRW1vdGVBbmltID0gRW1vdGVBbmltYXRpb25zW3ZhbHVlXQ0KICAgIGVuZA0KfSkNCg0KbG9jYWwgSHR0cCA9IChzeW4gYW5kIHN5bi5yZXF1ZXN0KSBvciAoaHR0cCBhbmQgaHR0cC5yZXF1ZXN0KSBvciAoZmx1eHVzIGFuZCBmbHV4dXMucmVxdWVzdCkgb3IgKHJlcXVlc3QpIG9yIChodHRwX3JlcXVlc3QpDQoNCmxvY2FsIHBsYWNlc0xpc3QgPSB7fQ0KbG9jYWwgbG9hZGluZ1BsYWNlcyA9IGZhbHNlDQoNCmxvY2FsIFRlbGVwb3J0ZXJHcm91cCA9IFRhYnMuTWlzYzpBZGRMZWZ0R3JvdXBib3goIlRlbGVwb3J0ZXIiLCAibmF2aWdhdGlvbiIpDQoNCmxvY2FsIFBsYWNlRHJvcGRvd24gPSBUZWxlcG9ydGVyR3JvdXA6QWRkRHJvcGRvd24oIlRlbGVwb3J0UGxhY2UiLCB7DQogICAgVmFsdWVzID0geyJMb2FkaW5nIHBsYWNlcy4uLiJ9LA0KICAgIERlZmF1bHQgPSAxLA0KICAgIE11bHRpID0gZmFsc2UsDQogICAgVGV4dCA9ICJTZWxlY3QgUGxhY2UiLA0KICAgIFRvb2x0aXAgPSAiQ2hvb3NlIGEgcGxhY2UgdG8gdGVsZXBvcnQgdG8iDQp9KQ0KDQpsb2NhbCBmdW5jdGlvbiBsb2FkUGxhY2VzKCkNCiAgICBpZiBsb2FkaW5nUGxhY2VzIHRoZW4gcmV0dXJuIGVuZA0KICAgIGxvYWRpbmdQbGFjZXMgPSB0cnVlDQogICAgDQogICAgaWYgbm90IEh0dHAgdGhlbg0KICAgICAgICBQbGFjZURyb3Bkb3duOlNldFZhbHVlcyh7IkN1cnJlbnQgUGxhY2UifSkNCiAgICAgICAgcGxhY2VzTGlzdFsiQ3VycmVudCBQbGFjZSJdID0gZ2FtZS5QbGFjZUlkDQogICAgICAgIGxvYWRpbmdQbGFjZXMgPSBmYWxzZQ0KICAgICAgICByZXR1cm4NCiAgICBlbmQNCiAgICANCiAgICBsb2NhbCB1bml2ZXJzZUlkID0gZ2FtZS5HYW1lSWQNCiAgICBsb2NhbCB1cmwgPSAiaHR0cHM6Ly9kZXZlbG9wLnJvYmxveC5jb20vdjEvdW5pdmVyc2VzLyIgLi4gdW5pdmVyc2VJZCAuLiAiL3BsYWNlcz9saW1pdD0xMDAiDQogICAgDQogICAgbG9jYWwgc3VjY2VzcywgcmVzcG9uc2UgPSBwY2FsbChmdW5jdGlvbigpDQogICAgICAgIHJldHVybiBIdHRwKHsNCiAgICAgICAgICAgIFVybCA9IHVybCwNCiAgICAgICAgICAgIE1ldGhvZCA9ICJHRVQiLA0KICAgICAgICAgICAgSGVhZGVycyA9IHsNCiAgICAgICAgICAgICAgICBbIlVzZXItQWdlbnQiXSA9ICJSb2Jsb3gvV2luSW5ldCIsDQogICAgICAgICAgICAgICAgWyJDb250ZW50LVR5cGUiXSA9ICJhcHBsaWNhdGlvbi9qc29uIg0KICAgICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgIGVuZCkNCiAgICANCiAgICBpZiBzdWNjZXNzIGFuZCByZXNwb25zZSBhbmQgcmVzcG9uc2UuQm9keSB0aGVuDQogICAgICAgIGxvY2FsIGRlY29kZVN1Y2Nlc3MsIGRhdGEgPSBwY2FsbChmdW5jdGlvbigpDQogICAgICAgICAgICByZXR1cm4gSHR0cFNlcnZpY2U6SlNPTkRlY29kZShyZXNwb25zZS5Cb2R5KQ0KICAgICAgICBlbmQpDQogICAgICAgIA0KICAgICAgICBpZiBkZWNvZGVTdWNjZXNzIGFuZCBkYXRhIGFuZCBkYXRhLmRhdGEgdGhlbg0KICAgICAgICAgICAgZm9yIF8sIHBsYWNlIGluIGlwYWlycyhkYXRhLmRhdGEpIGRvDQogICAgICAgICAgICAgICAgaWYgcGxhY2UubmFtZSBhbmQgcGxhY2UuaWQgdGhlbg0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBkaXNwbGF5TmFtZSA9IHBsYWNlLm5hbWUNCiAgICAgICAgICAgICAgICAgICAgaWYgcGxhY2UuaXNSb290UGxhY2UgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWUgPSBkaXNwbGF5TmFtZSAuLiAiIChSb290KSINCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgIHBsYWNlc0xpc3RbZGlzcGxheU5hbWVdID0gcGxhY2UuaWQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCiAgICANCiAgICBsb2NhbCBwbGFjZU5hbWVzID0ge30NCiAgICBmb3IgbmFtZSwgXyBpbiBwYWlycyhwbGFjZXNMaXN0KSBkbw0KICAgICAgICB0YWJsZS5pbnNlcnQocGxhY2VOYW1lcywgbmFtZSkNCiAgICBlbmQNCiAgICB0YWJsZS5zb3J0KHBsYWNlTmFtZXMpDQogICAgDQogICAgaWYgI3BsYWNlTmFtZXMgPiAwIHRoZW4NCiAgICAgICAgUGxhY2VEcm9wZG93bjpTZXRWYWx1ZXMocGxhY2VOYW1lcykNCiAgICAgICAgUGxhY2VEcm9wZG93bjpTZXRWYWx1ZShwbGFjZU5hbWVzWzFdKQ0KICAgIGVsc2UNCiAgICAgICAgUGxhY2VEcm9wZG93bjpTZXRWYWx1ZXMoeyJDdXJyZW50IFBsYWNlIn0pDQogICAgICAgIHBsYWNlc0xpc3RbIkN1cnJlbnQgUGxhY2UiXSA9IGdhbWUuUGxhY2VJZA0KICAgIGVuZA0KICAgIA0KICAgIGxvYWRpbmdQbGFjZXMgPSBmYWxzZQ0KZW5kDQoNCnRhc2suc3Bhd24obG9hZFBsYWNlcykNCg0KVGVsZXBvcnRlckdyb3VwOkFkZEJ1dHRvbih7DQogICAgVGV4dCA9ICJUZWxlcG9ydCIsDQogICAgRnVuYyA9IGZ1bmN0aW9uKCkNCiAgICAgICAgbG9jYWwgc2VsZWN0ZWQgPSBPcHRpb25zLlRlbGVwb3J0UGxhY2UuVmFsdWUNCiAgICAgICAgbG9jYWwgcGxhY2VJZCA9IHBsYWNlc0xpc3Rbc2VsZWN0ZWRdDQogICAgICAgIA0KICAgICAgICBpZiBwbGFjZUlkIHRoZW4NCiAgICAgICAgICAgIExpYnJhcnk6Tm90aWZ5KHsNCiAgICAgICAgICAgICAgICBUaXRsZSA9ICJUZWxlcG9ydGluZyIsDQogICAgICAgICAgICAgICAgRGVzY3JpcHRpb24gPSAiVGVsZXBvcnRpbmcgdG8gIiAuLiBzZWxlY3RlZCAuLiAiLi4uIiwNCiAgICAgICAgICAgICAgICBUaW1lID0gMywNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICANCiAgICAgICAgICAgIFRlbGVwb3J0U2VydmljZTpUZWxlcG9ydChwbGFjZUlkKQ0KICAgICAgICBlbmQNCiAgICBlbmQsDQogICAgVG9vbHRpcCA9ICJUZWxlcG9ydCB0byBzZWxlY3RlZCBwbGFjZSINCn0pDQoNClRlbGVwb3J0ZXJHcm91cDpBZGRCdXR0b24oew0KICAgIFRleHQgPSAiUmVqb2luIEN1cnJlbnQgU2VydmVyIiwNCiAgICBGdW5jID0gZnVuY3Rpb24oKQ0KICAgICAgICBMaWJyYXJ5Ok5vdGlmeSh7DQogICAgICAgICAgICBUaXRsZSA9ICJSZWpvaW5pbmciLA0KICAgICAgICAgICAgRGVzY3JpcHRpb24gPSAiUmVqb2luaW5nIGN1cnJlbnQgc2VydmVyLi4uIiwNCiAgICAgICAgICAgIFRpbWUgPSAzLA0KICAgICAgICB9KQ0KICAgICAgICANCiAgICAgICAgVGVsZXBvcnRTZXJ2aWNlOlRlbGVwb3J0VG9QbGFjZUluc3RhbmNlKGdhbWUuUGxhY2VJZCwgZ2FtZS5Kb2JJZCwgcGxheWVyKQ0KICAgIGVuZCwNCiAgICBUb29sdGlwID0gIlJlam9pbiB5b3VyIGN1cnJlbnQgc2VydmVyIg0KfSkNCg0KVGVsZXBvcnRlckdyb3VwOkFkZEJ1dHRvbih7DQogICAgVGV4dCA9ICJTZXJ2ZXIgSG9wIiwNCiAgICBGdW5jID0gZnVuY3Rpb24oKQ0KICAgICAgICBMaWJyYXJ5Ok5vdGlmeSh7DQogICAgICAgICAgICBUaXRsZSA9ICJTZXJ2ZXIgSG9wcGluZyIsDQogICAgICAgICAgICBEZXNjcmlwdGlvbiA9ICJGaW5kaW5nIGJlc3Qgc2VydmVyLi4uIiwNCiAgICAgICAgICAgIFRpbWUgPSAzLA0KICAgICAgICB9KQ0KICAgICAgICANCiAgICAgICAgbG9jYWwgc2VydmVycyA9IHt9DQogICAgICAgIGxvY2FsIGN1cnNvciA9ICIiDQogICAgICAgIA0KICAgICAgICByZXBlYXQNCiAgICAgICAgICAgIGxvY2FsIHVybCA9ICJodHRwczovL2dhbWVzLnJvYmxveC5jb20vdjEvZ2FtZXMvIiAuLiB0b3N0cmluZyhnYW1lLlBsYWNlSWQpIC4uICIvc2VydmVycy9QdWJsaWM/c29ydE9yZGVyPUFzYyZsaW1pdD0xMDAmY3Vyc29yPSIgLi4gY3Vyc29yDQogICAgICAgICAgICANCiAgICAgICAgICAgIGxvY2FsIHN1Y2Nlc3MsIHJlc3VsdCA9IHBjYWxsKGZ1bmN0aW9uKCkNCiAgICAgICAgICAgICAgICByZXR1cm4gZ2FtZTpIdHRwR2V0KHVybCkNCiAgICAgICAgICAgIGVuZCkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgc3VjY2VzcyB0aGVuDQogICAgICAgICAgICAgICAgbG9jYWwgZGVjb2RlZCA9IEh0dHBTZXJ2aWNlOkpTT05EZWNvZGUocmVzdWx0KQ0KICAgICAgICAgICAgICAgIGN1cnNvciA9IGRlY29kZWQubmV4dFBhZ2VDdXJzb3Igb3IgIiINCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBmb3IgXywgc2VydmVyIGluIHBhaXJzKGRlY29kZWQuZGF0YSkgZG8NCiAgICAgICAgICAgICAgICAgICAgaWYgc2VydmVyLnBsYXlpbmcgPCBzZXJ2ZXIubWF4UGxheWVycyBhbmQgc2VydmVyLmlkIH49IGdhbWUuSm9iSWQgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHNlcnZlcnMsIHNlcnZlcikNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIGVuZA0KICAgICAgICB1bnRpbCBjdXJzb3IgPT0gIiINCiAgICAgICAgDQogICAgICAgIGlmICNzZXJ2ZXJzID4gMCB0aGVuDQogICAgICAgICAgICB0YWJsZS5zb3J0KHNlcnZlcnMsIGZ1bmN0aW9uKGEsIGIpDQogICAgICAgICAgICAgICAgcmV0dXJuIGEucGxheWluZyA8IGIucGxheWluZw0KICAgICAgICAgICAgZW5kKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBUZWxlcG9ydFNlcnZpY2U6VGVsZXBvcnRUb1BsYWNlSW5zdGFuY2UoZ2FtZS5QbGFjZUlkLCBzZXJ2ZXJzWzFdLmlkLCBwbGF5ZXIpDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIExpYnJhcnk6Tm90aWZ5KHsNCiAgICAgICAgICAgICAgICBUaXRsZSA9ICJTZXJ2ZXIgSG9wIEZhaWxlZCIsDQogICAgICAgICAgICAgICAgRGVzY3JpcHRpb24gPSAiTm8gYXZhaWxhYmxlIHNlcnZlcnMgZm91bmQiLA0KICAgICAgICAgICAgICAgIFRpbWUgPSAzLA0KICAgICAgICAgICAgfSkNCiAgICAgICAgZW5kDQogICAgZW5kLA0KICAgIFRvb2x0aXAgPSAiSm9pbiB0aGUgc2VydmVyIHdpdGggdGhlIGxlYXN0IHBsYXllcnMiDQp9KQ0KDQpsb2NhbCBmdW5jdGlvbiBzZXRCR1Zpc2libGVUb1RydWUoKQ0KICAgIGZvciBfLCBtb2RlbCBpbiBwYWlycyh3b3Jrc3BhY2U6R2V0Q2hpbGRyZW4oKSkgZG8NCiAgICAgICAgaWYgbW9kZWw6SXNBKCJNb2RlbCIpIGFuZCBtb2RlbDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4NCiAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkUm9vdFBhcnQgPSBtb2RlbC5IdW1hbm9pZFJvb3RQYXJ0DQogICAgICAgICAgICBmb3IgXywgb2JqIGluIHBhaXJzKGh1bWFub2lkUm9vdFBhcnQ6R2V0RGVzY2VuZGFudHMoKSkgZG8NCiAgICAgICAgICAgICAgICBpZiBvYmo6SXNBKCJCaWxsYm9hcmRHdWkiKSBhbmQgb2JqLk5hbWUgPT0gIkluZm8iIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIGZyYW1lIGluIHBhaXJzKG9iajpHZXREZXNjZW5kYW50cygpKSBkbw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgZnJhbWU6SXNBKCJGcmFtZSIpIGFuZCBmcmFtZS5OYW1lID09ICJCRyIgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lLlZpc2libGUgPSB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gc2V0QkdWaXNpYmxlVG9GYWxzZSgpDQogICAgZm9yIF8sIG1vZGVsIGluIHBhaXJzKHdvcmtzcGFjZTpHZXRDaGlsZHJlbigpKSBkbw0KICAgICAgICBpZiBtb2RlbDpJc0EoIk1vZGVsIikgYW5kIG1vZGVsOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbg0KICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IG1vZGVsLkh1bWFub2lkUm9vdFBhcnQNCiAgICAgICAgICAgIGZvciBfLCBvYmogaW4gcGFpcnMoaHVtYW5vaWRSb290UGFydDpHZXREZXNjZW5kYW50cygpKSBkbw0KICAgICAgICAgICAgICAgIGlmIG9iajpJc0EoIkJpbGxib2FyZEd1aSIpIGFuZCBvYmouTmFtZSA9PSAiSW5mbyIgdGhlbg0KICAgICAgICAgICAgICAgICAgICBmb3IgXywgZnJhbWUgaW4gcGFpcnMob2JqOkdldERlc2NlbmRhbnRzKCkpIGRvDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBmcmFtZTpJc0EoIkZyYW1lIikgYW5kIGZyYW1lLk5hbWUgPT0gIkJHIiB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuVmlzaWJsZSA9IGZhbHNlDQogICAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQplbmQNCg0KTWlzY0dyb3VwOkFkZFRvZ2dsZSgiU2hvd1JlY29yZHMiLCB7DQogICAgVGV4dCA9ICJTaG93IGFsbCBSZWNvcmRzL1N0cmVha3MiLA0KICAgIERlZmF1bHQgPSBmYWxzZSwNCiAgICBUb29sdGlwID0gIlVuaGlkZSBhbGwgcmVjb3JkcyBhbmQgc3RyZWFrcyIsDQogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih2YWx1ZSkNCiAgICAgICAgaWYgdmFsdWUgdGhlbg0KICAgICAgICAgICAgc2V0QkdWaXNpYmxlVG9UcnVlKCkNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgc2V0QkdWaXNpYmxlVG9GYWxzZSgpDQogICAgICAgIGVuZA0KICAgIGVuZA0KfSkNCg0KTWVudUdyb3VwOkFkZFRvZ2dsZSgiS2V5YmluZE1lbnVPcGVuIiwgew0KICAgIERlZmF1bHQgPSBMaWJyYXJ5LktleWJpbmRGcmFtZS5WaXNpYmxlLA0KICAgIFRleHQgPSAiT3BlbiBLZXliaW5kIE1lbnUiLA0KICAgIENhbGxiYWNrID0gZnVuY3Rpb24odmFsdWUpDQogICAgICAgIExpYnJhcnkuS2V5YmluZEZyYW1lLlZpc2libGUgPSB2YWx1ZQ0KICAgIGVuZCwNCn0pDQoNCk1lbnVHcm91cDpBZGRUb2dnbGUoIlNob3dDdXN0b21DdXJzb3IiLCB7DQogICAgVGV4dCA9ICJDdXN0b20gQ3Vyc29yIiwNCiAgICBEZWZhdWx0ID0gZmFsc2UsDQogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkNCiAgICAgICAgTGlicmFyeS5TaG93Q3VzdG9tQ3Vyc29yID0gVmFsdWUNCiAgICBlbmQsDQp9KQ0KDQpNZW51R3JvdXA6QWRkRHJvcGRvd24oIk5vdGlmaWNhdGlvblNpZGUiLCB7DQogICAgVmFsdWVzID0geyAiTGVmdCIsICJSaWdodCIgfSwNCiAgICBEZWZhdWx0ID0gIlJpZ2h0IiwNCiAgICBUZXh0ID0gIk5vdGlmaWNhdGlvbiBTaWRlIiwNCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQ0KICAgICAgICBMaWJyYXJ5OlNldE5vdGlmeVNpZGUoVmFsdWUpDQogICAgZW5kLA0KfSkNCg0KTWVudUdyb3VwOkFkZERyb3Bkb3duKCJEUElEcm9wZG93biIsIHsNCiAgICBWYWx1ZXMgPSB7ICI1MCUiLCAiNzUlIiwgIjEwMCUiLCAiMTI1JSIsICIxNTAlIiwgIjE3NSUiLCAiMjAwJSIgfSwNCiAgICBEZWZhdWx0ID0gIjEwMCUiLA0KICAgIFRleHQgPSAiRFBJIFNjYWxlIiwNCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQ0KICAgICAgICBWYWx1ZSA9IFZhbHVlOmdzdWIoIiUlIiwgIiIpDQogICAgICAgIGxvY2FsIERQSSA9IHRvbnVtYmVyKFZhbHVlKQ0KICAgICAgICBMaWJyYXJ5OlNldERQSVNjYWxlKERQSSkNCiAgICBlbmQsDQp9KQ0KDQpNZW51R3JvdXA6QWRkRGl2aWRlcigpDQoNCk1lbnVHcm91cDpBZGRMYWJlbCgiTWVudSBiaW5kIik6QWRkS2V5UGlja2VyKCJNZW51S2V5YmluZCIsIHsgDQogICAgRGVmYXVsdCA9ICJMZWZ0Q29udHJvbCIsIA0KICAgIE5vVUkgPSB0cnVlLCANCiAgICBUZXh0ID0gIk1lbnUga2V5YmluZCIgDQp9KQ0KDQpNZW51R3JvdXA6QWRkQnV0dG9uKCJVbmxvYWQiLCBmdW5jdGlvbigpDQogICAgTGlicmFyeTpVbmxvYWQoKQ0KZW5kKQ0KDQpMaWJyYXJ5LlRvZ2dsZUtleWJpbmQgPSBPcHRpb25zLk1lbnVLZXliaW5kDQoNCk1lbnVHcm91cDpBZGREaXZpZGVyKCkNCk1lbnVHcm91cDpBZGRMYWJlbCgiVGhlbWVNYW5hZ2VyIiwgdHJ1ZSkNCk1lbnVHcm91cDpBZGRMYWJlbCgiU2F2ZU1hbmFnZXIiLCB0cnVlKQ0KDQpUaGVtZU1hbmFnZXI6U2V0TGlicmFyeShMaWJyYXJ5KQ0KU2F2ZU1hbmFnZXI6U2V0TGlicmFyeShMaWJyYXJ5KQ0KDQpTYXZlTWFuYWdlcjpJZ25vcmVUaGVtZVNldHRpbmdzKCkNClNhdmVNYW5hZ2VyOlNldElnbm9yZUluZGV4ZXMoeyAiTWVudUtleWJpbmQiIH0pDQoNClRoZW1lTWFuYWdlcjpTZXRGb2xkZXIoIlZ5bnh6SHViIikNClNhdmVNYW5hZ2VyOlNldEZvbGRlcigiVnlueHpIdWIvY29uZmlncyIpDQoNClNhdmVNYW5hZ2VyOkJ1aWxkQ29uZmlnU2VjdGlvbihUYWJzWyJVSSBTZXR0aW5ncyJdKQ0KVGhlbWVNYW5hZ2VyOkFwcGx5VG9UYWIoVGFic1siVUkgU2V0dGluZ3MiXSkNCg0KU2F2ZU1hbmFnZXI6TG9hZEF1dG9sb2FkQ29uZmlnKCkNCg0KTGlicmFyeTpPblVubG9hZChmdW5jdGlvbigpDQogICAgTGlicmFyeS5VbmxvYWRlZCA9IHRydWUNCiAgICBpZiB2aXNpYmxlQ29ubiB0aGVuDQogICAgICAgIHZpc2libGVDb25uOkRpc2Nvbm5lY3QoKQ0KICAgIGVuZA0KICAgIGlmIGF1dG9HdWFyZENvbm5lY3Rpb24gdGhlbg0KICAgICAgICBhdXRvR3VhcmRDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQ0KICAgIGVuZA0KICAgIGlmIHNwZWVkQm9vc3RDb25uZWN0aW9uIHRoZW4NCiAgICAgICAgc3BlZWRCb29zdENvbm5lY3Rpb24oKQ0KICAgIGVuZA0KICAgIGlmIG1hZ25ldENvbm5lY3Rpb24gdGhlbg0KICAgICAgICBtYWduZXRDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQ0KICAgIGVuZA0KICAgIGRpc2FibGVBbmltYXRpb25TcG9vZigpDQplbmQp"
